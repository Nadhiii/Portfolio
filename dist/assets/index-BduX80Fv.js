const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Experience-4Wi9XU6W.js","assets/animations-BPvGG8hj.js","assets/vendor-B_5ubShz.js","assets/ui-fj58c61q.js","assets/three-Duswj64z.js","assets/lenis-Bu7sAdyK.js","assets/email-DtVQIX_c.js","assets/Pluto-GN0SAuKT.js","assets/slider-BhAfAOF6.js"])))=>i.map(i=>d[i]);
import{C as Nr,F as Ir,O as Pr,a as kt,u as $r,M as St,_ as ir,R as Ur}from"./three-Duswj64z.js";import{j as o,A as V,m as v,L as Lr,u as jt,a as Et}from"./animations-BPvGG8hj.js";import{r as _,N as de,e as Dr,L as yt,u as Br,f as Fe,R as H,O as Mr,h as qr,i as Fr}from"./vendor-B_5ubShz.js";import{X as ar,C as or,M as zr,a as Vr,S as Wr,b as st,G as Kr,c as lr,d as Le,L as De,F as Hr,A as Gr,T as Jr,R as Yr,H as cr,e as Xr,f as Qr,g as nt,h as Zr,i as es,j as ts,k as ur,l as dr,U as Tt,m as Ke,n as rs,o as ss,E as ns,p as is,B as as,q as os,Z as ls,P as At,r as cs,s as us,t as ds,u as hs,v as fs}from"./ui-fj58c61q.js";import{L as gs}from"./lenis-Bu7sAdyK.js";import{e as ps}from"./email-DtVQIX_c.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();const N=(r,e,t,s=null)=>{if(window.dataLayer){const n={event:r,event_category:e,event_label:t};s!==null&&(n.value=s),window.dataLayer.push(n)}},pe=(r,e=null)=>{window.dataLayer&&window.dataLayer.push({event:"page_view",page_title:r,page_section:e})},ms=(r,e="91")=>{if(!r)return"";let t=r.replace(/\D/g,"");return t.length===10&&(t=e+t),"+"+t},ys=r=>{if(window.dataLayer){const e=r.phone?ms(r.phone):"",t={email:r.email||"",firstName:r.firstName||r.name?.split(" ")[0]||"",lastName:r.lastName||r.name?.split(" ").slice(1).join(" ")||""},s={event:"form_success",event_category:"engagement",event_label:"contact_form",email:t.email,phone_number:e,first_name:t.firstName,last_name:t.lastName};window.dataLayer.push(s)}},ws=()=>{const[r,e]=_.useState(!1),[t,s]=_.useState(!1),n=_.useRef(null),i=_.useRef(null);_.useEffect(()=>(s(!0),()=>s(!1)),[]),_.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[r]),_.useEffect(()=>{if(!r)return;setTimeout(()=>i.current?.focus(),100);const u=d=>{if(d.key==="Escape"&&e(!1),d.key==="Tab"&&n.current){const h=n.current.querySelectorAll('button, a[href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!h||h.length===0)return;const g=h[0],f=h[h.length-1];d.shiftKey&&document.activeElement===g?(d.preventDefault(),f.focus()):!d.shiftKey&&document.activeElement===f&&(d.preventDefault(),g.focus())}};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[r]);const a=()=>{e(!r),r||N("mobile_menu_open","Navigation","Mobile menu opened")},l=u=>{N("mobile_nav_click","Navigation",`${u} section visited (mobile)`),e(!1)},c=o.jsx(V,{children:r&&o.jsxs(o.Fragment,{children:[o.jsx(v.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 z-[60] bg-black/40 backdrop-blur-[2px]",onClick:a}),o.jsxs(v.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:30,stiffness:300},className:"fixed inset-y-0 right-0 z-[70] w-[85%] max-w-xs bg-white/60 dark:bg-black/60 backdrop-blur-2xl border-l border-white/20 dark:border-white/10 shadow-2xl p-6 flex flex-col",onClick:u=>u.stopPropagation(),ref:n,role:"dialog","aria-modal":"true","aria-label":"Navigation menu",children:[o.jsxs("div",{className:"flex justify-between items-center mb-10",children:[o.jsx("span",{className:"font-heading text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Menu"}),o.jsx(v.button,{ref:i,onClick:a,whileTap:{scale:.9},className:"p-2 rounded-full bg-white/20 dark:bg-white/10 border border-white/20 text-gray-900 dark:text-white","aria-label":"Close navigation menu",children:o.jsx(ar,{size:24})})]}),o.jsx("ul",{className:"space-y-3 flex-1",children:[{name:"Projects",path:"/projects"},{name:"Skills",path:"/skills"},{name:"Experience",path:"/experience"},{name:"Contact",path:"/contact"},{name:"Pluto",path:"/pluto"}].map((u,d)=>o.jsx(v.li,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.1+d*.05},children:o.jsx(de,{to:u.path,onClick:()=>l(u.name),className:({isActive:h})=>`
                      group flex items-center justify-between px-5 py-4 rounded-2xl text-lg font-medium transition-all duration-300 border
                      ${h?"bg-primary-light/10 dark:bg-primary-dark/10 border-primary-light/20 dark:border-primary-dark/20 text-primary-light dark:text-primary-dark shadow-[0_0_15px_rgba(59,130,246,0.15)]":"bg-transparent border-transparent text-gray-600 dark:text-gray-400 hover:bg-white/10 dark:hover:bg-white/5 hover:text-gray-900 dark:hover:text-white"}
                    `,children:({isActive:h})=>o.jsxs(o.Fragment,{children:[o.jsx("span",{children:u.name}),h&&o.jsx(or,{size:18,className:"animate-pulse"})]})})},u.name))}),o.jsx("div",{className:"pt-8 border-t border-gray-200/20 dark:border-white/10",children:o.jsxs("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 font-medium",children:["© ",new Date().getFullYear()," Mahanadhi Parisara"]})})]})]})});return o.jsxs("div",{className:"md:hidden",children:[o.jsx(v.button,{onClick:a,whileTap:{scale:.95},className:"p-2.5 rounded-full bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 text-gray-800 dark:text-gray-200 shadow-sm","aria-label":"Open Menu",children:o.jsx(zr,{size:24})}),t&&Dr.createPortal(c,document.body)]})},bs=({theme:r,onThemeSwitch:e})=>{const[t,s]=_.useState(!1);_.useEffect(()=>{const i=()=>{s(window.scrollY>20)};return window.addEventListener("scroll",i,{passive:!0}),()=>window.removeEventListener("scroll",i)},[]);const n=({isActive:i})=>`
    px-4 py-2 rounded-lg transition-all duration-300 relative group
    text-text-light dark:text-text-dark
    ${i?"text-primary-light dark:text-primary-dark font-semibold":""}
    after:content-['']
    after:absolute
    after:bottom-0
    after:left-4
    after:w-0
    after:h-0.5
    after:bg-primary-light
    dark:after:bg-primary-dark
    after:transition-all
    after:duration-300
    ${i?"after:w-[calc(100%-32px)]":"group-hover:after:w-[calc(100%-32px)]"}
  `;return o.jsx("div",{className:"fixed top-4 left-0 right-0 z-40 flex justify-center px-4",children:o.jsx(v.header,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6,ease:[.34,1.56,.64,1]},className:"w-full max-w-6xl",children:o.jsx("div",{className:`
        relative px-6 py-3 rounded-full 
        bg-white/28 dark:bg-black/24 
        backdrop-blur-3xl backdrop-saturate-150
        border border-transparent
        transition-all duration-300
        ${t?"shadow-2xl shadow-gray-400/25 dark:shadow-black/45":"shadow-xl shadow-gray-300/30 dark:shadow-black/35"}
      `,children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx(yt,{to:"/","aria-label":"Back to homepage",onClick:()=>N("logo_click","Navigation","Header logo clicked"),children:o.jsx(Lr,{children:o.jsx(v.div,{className:"flex items-center gap-2 font-heading text-xl h-8",children:o.jsx(V,{children:t?o.jsxs(v.div,{className:"flex items-center gap-1 group relative",children:[o.jsx(v.span,{layoutId:"first-token",className:"text-2xl",children:"M"}),o.jsx(v.span,{layoutId:"second-token",className:"text-2xl",children:"P"})]},"initials"):o.jsxs(v.div,{className:"flex items-center gap-2",children:[o.jsx(v.span,{layoutId:"first-token",children:"Mahanadhi"}),o.jsx(v.span,{layoutId:"second-token",children:"Parisara"})]},"fullName")})})})}),o.jsxs("nav",{className:"flex items-center gap-2 md:gap-3",children:[o.jsxs("ul",{className:"hidden md:flex items-center gap-2 font-body",children:[o.jsx("li",{children:o.jsx(de,{to:"/projects",onClick:()=>N("nav_click","Navigation","Projects section visited"),className:n,children:"Projects"})}),o.jsx("li",{children:o.jsx(de,{to:"/skills",onClick:()=>N("nav_click","Navigation","Skills section visited"),className:n,children:"Skills"})}),o.jsx("li",{children:o.jsx(de,{to:"/experience",onClick:()=>N("nav_click","Navigation","Experience page visited"),className:n,children:"Experience"})}),o.jsx("li",{children:o.jsx(de,{to:"/contact",onClick:()=>N("nav_click","Navigation","Contact section visited"),className:n,children:"Contact"})}),o.jsx("li",{children:o.jsx(de,{to:"/pluto",onClick:()=>N("nav_click","Navigation","Pluto page visited"),className:n,children:"Pluto"})})]}),o.jsx("button",{onClick:i=>{e(i),N("theme_toggle","Engagement",`Switched to ${r==="light"?"dark":"light"} mode`)},className:"bg-white/40 dark:bg-gray-800/40 p-2 rounded-full hover:bg-gray-600 dark:hover:bg-gray-700 hover:text-white transition-all duration-300","aria-label":"Toggle theme",children:r==="light"?o.jsx(Vr,{size:20}):o.jsx(Wr,{size:20})}),o.jsx(ws,{})]})]})})})})},vs=({onClick:r})=>{const[e,t]=_.useState(!1),s=()=>{N("calendar_click","Engagement","Calendar modal opened"),r()};return o.jsxs(v.button,{onClick:s,onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1),whileHover:{scale:1.05,y:-2},whileTap:{scale:.98},className:"fixed bottom-8 right-8 z-50 flex items-center gap-3 bg-primary-light text-white font-bold py-3 px-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden","aria-label":"Book an appointment",children:[o.jsx(st,{size:20,className:"flex-shrink-0"}),o.jsx(V,{children:e&&o.jsx(v.span,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.3,ease:[.25,.46,.45,.94]},className:"whitespace-nowrap overflow-hidden",children:"Book an appointment"})})]})},_s=({isOpen:r,onClose:e,theme:t})=>{const s=_.useRef(null),n=_.useRef(null);_.useEffect(()=>(r?(N("calendar_modal_opened","Engagement",`Calendar modal opened in ${t} mode`),setTimeout(()=>n.current?.focus(),100),document.body.style.overflow="hidden"):document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r,t]),_.useEffect(()=>{if(!r)return;const l=c=>{if(c.key==="Escape"&&i(),c.key==="Tab"){const u=s.current?.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!u||u.length===0)return;const d=u[0],h=u[u.length-1];c.shiftKey&&document.activeElement===d?(c.preventDefault(),h.focus()):!c.shiftKey&&document.activeElement===h&&(c.preventDefault(),d.focus())}};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)},[r]);const i=_.useCallback(()=>{N("calendar_modal_closed","Engagement","Calendar modal closed"),e()},[e]);return r?o.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/70 backdrop-blur-sm",onClick:i,role:"dialog","aria-modal":"true","aria-label":"Schedule a call",children:o.jsxs("div",{ref:s,className:"relative w-11/12 max-w-4xl h-5/6 bg-white rounded-lg shadow-2xl overflow-hidden",onClick:l=>l.stopPropagation(),children:[o.jsx("button",{ref:n,onClick:i,className:"absolute top-3 right-3 z-10 bg-white text-gray-800 p-2 rounded-full shadow-lg hover:bg-gray-100 transition-colors","aria-label":"Close calendar modal",children:o.jsx(ar,{size:24})}),o.jsx("div",{className:"w-full h-full rounded-lg overflow-hidden",children:o.jsx("iframe",{src:"https://calendar.google.com/calendar/appointments/schedules/AcZssZ2PrInWpWnFVLWvxUVR_Dr_mUK1D_FY_gHhG7MLaPBpHwPn10_IouKmbTqcnPeZwIKxzUQOG9y-?gv=true",className:"w-full h-full",style:{border:0},title:"Google Calendar Appointments",allow:"camera; microphone"})})]})}):null},xs=({onAnimationComplete:r})=>{const[e,t]=_.useState(!0);return _.useEffect(()=>{const s=setTimeout(()=>{t(!1)},2500);return()=>clearTimeout(s)},[]),o.jsx(V,{mode:"wait",onExitComplete:()=>r(),children:e&&o.jsxs(v.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-50 dark:bg-black overflow-hidden",initial:{y:0},exit:{y:"-100%",transition:{duration:.8,ease:[.76,0,.24,1],delay:.2}},children:[o.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center w-full max-w-4xl px-4",children:[o.jsx(v.div,{className:"overflow-hidden",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,y:-20,transition:{duration:.3}},children:o.jsx("h1",{className:"font-heading text-4xl sm:text-6xl md:text-8xl font-bold tracking-tighter text-gray-900 dark:text-white uppercase",children:o.jsx(Ot,{text:"Mahanadhi"})})}),o.jsx(v.div,{className:"h-[2px] bg-gray-900 dark:bg-white my-4 sm:my-6",initial:{width:0},animate:{width:"100px"},exit:{width:0,opacity:0,transition:{duration:.3}},transition:{duration:.8,ease:"easeInOut",delay:.2}}),o.jsx(v.div,{className:"overflow-hidden",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,y:20,transition:{duration:.3}},children:o.jsx("h1",{className:"font-heading text-4xl sm:text-6xl md:text-8xl font-bold tracking-tighter text-gray-400 dark:text-gray-500 uppercase",children:o.jsx(Ot,{text:"Parisara",delay:.4})})}),o.jsxs(v.div,{className:"mt-8 sm:mt-12 w-32 sm:w-48",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.2}},transition:{delay:.8},children:[o.jsx("div",{className:"h-[1px] w-full bg-gray-200 dark:bg-gray-800 rounded-full overflow-hidden",children:o.jsx(v.div,{className:"h-full bg-gray-900 dark:bg-white rounded-full",initial:{width:"0%"},animate:{width:"100%"},transition:{duration:1.5,delay:.8,ease:[.25,.46,.45,.94]}})}),o.jsx(v.p,{className:"text-[10px] tracking-[0.3em] uppercase text-gray-400 dark:text-gray-600 text-center mt-3 font-medium",initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:"Loading"})]})]}),o.jsx("div",{className:"absolute inset-0 z-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:"linear-gradient(#000 1px, transparent 1px), linear-gradient(90deg, #000 1px, transparent 1px)",backgroundSize:"40px 40px"}})]},"intro-overlay")})},Ot=({text:r,delay:e=0})=>{const t=r.split("");return o.jsx("span",{className:"inline-flex",children:t.map((s,n)=>o.jsx(v.span,{initial:{y:40,opacity:0,filter:"blur(10px)"},animate:{y:0,opacity:1,filter:"blur(0px)"},transition:{duration:.8,ease:[.2,.65,.3,.9],delay:e+n*.05},className:"inline-block",children:s},n))})},ks=()=>o.jsxs("footer",{className:"relative z-10 py-8 text-center",children:[o.jsx("div",{className:"max-w-xs mx-auto h-px bg-gradient-to-r from-transparent via-gray-300 dark:via-gray-700 to-transparent mb-6 opacity-50"}),o.jsxs("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:["© ",new Date().getFullYear()," Mahanadhi Parisara. Built with curiosity."]})]}),Ss=()=>{const[r,e]=_.useState(0),[t,s]=_.useState(!1),n=Br(),i=Fe(),a=_.useMemo(()=>{const u=i.pathname;return u==="/projects"?[{id:"github",label:"GitHub",icon:Kr,action:"github",color:"hover:text-black dark:hover:text-white"},{id:"contact-quick",label:"Let's Talk",icon:lr,action:"contact",color:"hover:text-green-500"}]:u==="/contact"?[{id:"email",label:"Email",icon:Le,action:"email",color:"hover:text-blue-500"},{id:"linkedin",label:"LinkedIn",icon:De,action:"linkedin",color:"hover:text-blue-600"}]:[{id:"resume",label:"Resume",icon:Hr,action:"resume",color:"hover:text-purple-500"},{id:"linkedin-main",label:"LinkedIn",icon:De,action:"linkedin",color:"hover:text-blue-600"}]},[i.pathname]),l=_.useCallback(u=>{switch(u){case"github":window.open("https://github.com/Nadhiii","_blank");break;case"contact":n("/contact");break;case"email":window.open("mailto:mahanadhip@gmail.com","_blank");break;case"linkedin":window.open("https://www.linkedin.com/in/mahanadhi/","_blank");break;case"resume":window.open("https://drive.google.com/file/d/1dBcASDXDvYTuDoaSr4-7XQS0-kH9QZ_T/view?usp=drive_link","_blank");break}},[n]);_.useEffect(()=>{const u=()=>{const d=document.documentElement.scrollHeight-window.innerHeight,h=d>0?window.scrollY/d*100:0;e(h),s(window.scrollY>100)};return window.addEventListener("scroll",u,{passive:!0}),u(),()=>window.removeEventListener("scroll",u)},[]);const c=()=>{window.scrollTo({top:0,behavior:"smooth"})};return o.jsx(V,{children:t&&o.jsxs(v.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},className:"fixed right-6 top-1/2 -translate-y-1/2 z-40 hidden md:flex items-center gap-3",children:[o.jsx("div",{className:"h-32 w-[3px] bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden relative hidden lg:block",children:o.jsx(v.div,{className:"absolute top-0 left-0 w-full bg-gradient-to-b from-primary-light to-accent-green-light dark:from-primary-dark dark:to-accent-green-dark shadow-[0_0_10px_rgba(59,130,246,0.6)]",style:{height:`${r}%`}})}),o.jsxs("div",{className:"flex flex-col gap-4 p-3 rounded-full bg-white/60 dark:bg-black/60 backdrop-blur-xl border border-white/40 dark:border-white/10 shadow-2xl shadow-black/5 dark:shadow-black/20",children:[a.map((u,d)=>o.jsxs(v.button,{onClick:()=>l(u.action),initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{delay:d*.1},whileHover:{scale:1.15},whileTap:{scale:.95},className:`w-10 h-10 flex items-center justify-center rounded-full text-gray-500 dark:text-gray-400 transition-colors bg-transparent hover:bg-white dark:hover:bg-gray-800 ${u.color} group relative`,children:[o.jsx(u.icon,{size:20,strokeWidth:1.5}),o.jsxs("span",{className:"absolute right-12 opacity-0 group-hover:opacity-100 transition-opacity bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900 text-xs font-bold py-1.5 px-3 rounded-lg whitespace-nowrap pointer-events-none shadow-lg",children:[u.label,o.jsx("span",{className:"absolute -right-1 top-1/2 -translate-y-1/2 border-4 border-transparent border-l-gray-900 dark:border-l-gray-100"})]})]},u.id)),o.jsx("div",{className:"w-5 h-[1px] bg-gray-300 dark:bg-gray-600 mx-auto opacity-50"}),o.jsx(v.button,{onClick:c,whileHover:{scale:1.15},whileTap:{scale:.95},className:"w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 hover:text-primary-light dark:hover:text-primary-dark transition-colors",children:o.jsx(Gr,{size:20,strokeWidth:1.5})})]})]})})},js=({isActive:r,onComplete:e,theme:t})=>{const[s,n]=_.useState("idle");if(_.useEffect(()=>{r&&(n("covering"),setTimeout(()=>{e(),n("revealing"),setTimeout(()=>{n("idle")},500)},500))},[r,e]),!r&&s==="idle")return null;const i=t==="dark";return o.jsx(V,{children:s!=="idle"&&o.jsxs(v.div,{className:"fixed inset-0 z-[9999] pointer-events-none flex flex-col",initial:{opacity:1},exit:{opacity:0},children:[o.jsx(v.div,{className:`flex-1 w-full ${i?"bg-black":"bg-white"}`,initial:{scaleY:0},animate:{scaleY:s==="covering"?1:0,transformOrigin:"top"},transition:{duration:.5,ease:[.22,1,.36,1]}}),o.jsx(v.div,{className:`flex-1 w-full ${i?"bg-black":"bg-white"}`,initial:{scaleY:0},animate:{scaleY:s==="covering"?1:0,transformOrigin:"bottom"},transition:{duration:.5,ease:[.22,1,.36,1]}})]})})},Es=()=>{const{pathname:r}=Fe();return _.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),_.useEffect(()=>{window.scrollTo(0,0)},[r]),null},Ts=()=>{const r=jt(-100),e=jt(-100),[t,s]=_.useState(!1),[n,i]=_.useState(!1),[a,l]=_.useState(""),[c,u]=_.useState(!1),d={damping:25,stiffness:300,mass:.5},h=Et(r,d),g=Et(e,d);return _.useEffect(()=>{if(window.matchMedia("(pointer: coarse)").matches)return;const f=R=>{r.set(R.clientX),e.set(R.clientY),c||u(!0)},p=()=>i(!0),m=()=>i(!1),w=R=>{const T=R.target.closest('a, button, [data-cursor="pointer"], input, textarea, select');if(T){s(!0);const A=T.getAttribute("data-cursor-text");A&&l(A)}},b=R=>{R.target.closest('a, button, [data-cursor="pointer"], input, textarea, select')&&(s(!1),l(""))},x=()=>u(!1),y=()=>u(!0);window.addEventListener("mousemove",f,{passive:!0}),window.addEventListener("mousedown",p),window.addEventListener("mouseup",m),document.addEventListener("mouseover",w,{passive:!0}),document.addEventListener("mouseout",b,{passive:!0}),document.documentElement.addEventListener("mouseleave",x),document.documentElement.addEventListener("mouseenter",y),document.documentElement.style.cursor="none";const E=document.createElement("style");return E.id="custom-cursor-style",E.textContent=`
      *, *::before, *::after { cursor: none !important; }
    `,document.head.appendChild(E),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mousedown",p),window.removeEventListener("mouseup",m),document.removeEventListener("mouseover",w),document.removeEventListener("mouseout",b),document.documentElement.removeEventListener("mouseleave",x),document.documentElement.removeEventListener("mouseenter",y),document.documentElement.style.cursor="",document.getElementById("custom-cursor-style")?.remove()}},[]),typeof window<"u"&&window.matchMedia("(pointer: coarse)").matches?null:o.jsxs(o.Fragment,{children:[o.jsx(v.div,{className:"fixed top-0 left-0 pointer-events-none z-[9999] mix-blend-difference",style:{x:h,y:g},children:o.jsx(v.div,{animate:{width:t?60:32,height:t?60:32,opacity:c?1:0,scale:n?.8:1,x:"-50%",y:"-50%"},transition:{duration:.2,ease:"easeOut"},className:"rounded-full border border-white flex items-center justify-center",children:a&&o.jsx(v.span,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},className:"text-white text-[10px] font-bold uppercase tracking-wider",children:a})})}),o.jsx(v.div,{className:"fixed top-0 left-0 pointer-events-none z-[9999] mix-blend-difference",style:{x:r,y:e},children:o.jsx(v.div,{animate:{width:t?4:6,height:t?4:6,opacity:c?1:0,x:"-50%",y:"-50%"},transition:{duration:.15},className:"rounded-full bg-white"})})]})},As=H.memo(Ts);let He=null;const Os=()=>(!He&&typeof window<"u"&&(window.AudioContext||window.webkitAudioContext)&&(He=new(window.AudioContext||window.webkitAudioContext)),He),Rs=()=>{if(!(typeof window>"u"))try{const r=Os();if(!r)return;r.state==="suspended"&&r.resume();const e=r.createOscillator(),t=r.createGain();e.connect(t),t.connect(r.destination),e.type="sine",e.frequency.setValueAtTime(400,r.currentTime),e.frequency.exponentialRampToValueAtTime(600,r.currentTime+.2),e.frequency.exponentialRampToValueAtTime(300,r.currentTime+.4),t.gain.setValueAtTime(0,r.currentTime),t.gain.linearRampToValueAtTime(.08,r.currentTime+.05),t.gain.exponentialRampToValueAtTime(.01,r.currentTime+.5),e.start(r.currentTime),e.stop(r.currentTime+.5),e.onended=()=>{t.disconnect(),e.disconnect()}}catch(r){console.debug("Audio context not available:",r)}},Cs=r=>{const[e,t]=_.useState(!1),[s,n]=_.useState(null),i=_.useCallback(l=>{if(e)return;const c=l.target.getBoundingClientRect(),u={x:c.left+c.width/2,y:c.top+c.height/2};n(u),t(!0),navigator.vibrate&&navigator.vibrate([8]),Rs(),setTimeout(()=>{r()},200)},[e,r]),a=_.useCallback(()=>{t(!1),n(null)},[]);return{isTransitioning:e,startPosition:s,triggerThemeTransition:i,completeTransition:a}},Ns=(r=!0)=>{const e=_.useRef(null);return _.useEffect(()=>{if(!r||window.matchMedia("(prefers-reduced-motion: reduce)").matches)return;const t=new gs({duration:1.2,easing:n=>Math.min(1,1.001-Math.pow(2,-10*n)),orientation:"vertical",gestureOrientation:"vertical",smoothWheel:!0,wheelMultiplier:1,touchMultiplier:2});e.current=t;function s(n){t.raf(n),requestAnimationFrame(s)}return requestAnimationFrame(s),()=>{t.destroy(),e.current=null}},[r]),e};function Is({count:r=80,isDark:e}){const t=_.useRef(),s=_.useMemo(()=>new Pr,[]),n=_.useMemo(()=>new kt("#3B82F6"),[]),i=_.useMemo(()=>new kt("#818CF8"),[]),a=_.useMemo(()=>{const l=[];for(let c=0;c<r;c++){const u=Math.random()*100,d=20+Math.random()*100,h=.01+Math.random()/200,g=-50+Math.random()*100,f=-30+Math.random()*60,p=-30+Math.random()*60;l.push({t:u,factor:d,speed:h,xFactor:g,yFactor:f,zFactor:p,mx:0,my:0})}return l},[r]);return $r(l=>{if(!t.current)return;const{mouse:c}=l;t.current.rotation.x=St.lerp(t.current.rotation.x,c.y*.05,.05),t.current.rotation.y=St.lerp(t.current.rotation.y,c.x*.05,.05),a.forEach((u,d)=>{let{t:h,factor:g,speed:f,xFactor:p,yFactor:m,zFactor:w}=u;h=u.t+=f/3;const b=Math.cos(h)+Math.sin(h*1)/10,x=Math.sin(h)+Math.cos(h*2)/10,y=Math.cos(h)*.5+.5;s.position.set(u.mx/10*b+p+Math.cos(h/10*g)+Math.sin(h*1)*g/10,u.my/10*x+m+Math.sin(h/10*g)+Math.cos(h*2)*g/10,u.my/10*x+w+Math.cos(h/10*g)+Math.sin(h*3)*g/10),s.rotation.set(y*2,y*2,y*2);const E=Math.max(.5,Math.cos(h)*1.5);s.scale.set(E,E,E),s.updateMatrix(),t.current.setMatrixAt(d,s.matrix)}),t.current.instanceMatrix.needsUpdate=!0}),o.jsxs("instancedMesh",{ref:t,args:[null,null,r],children:[o.jsx("icosahedronGeometry",{args:[.15,0]}),o.jsx("meshStandardMaterial",{color:e?i:n,transparent:!0,opacity:e?.6:.5,roughness:.4,metalness:.6})]})}const Ps=({theme:r="light"})=>{const e=r==="dark"||typeof document<"u"&&document.documentElement.classList.contains("dark");return o.jsx("div",{className:"fixed inset-0 z-0 pointer-events-auto",children:o.jsxs(Nr,{camera:{position:[0,0,20],fov:60},gl:{alpha:!0,antialias:!0,powerPreference:"high-performance"},dpr:[1,1.5],style:{pointerEvents:"auto"},children:[o.jsx("ambientLight",{intensity:.4}),o.jsx("pointLight",{position:[10,10,10],intensity:1.5,color:e?"#818CF8":"#3B82F6"}),o.jsx("pointLight",{position:[-10,-10,-10],intensity:.5,color:"white"}),o.jsx(Ir,{speed:2,rotationIntensity:.5,floatIntensity:.5,children:o.jsx(Is,{count:70,isDark:e})}),o.jsx("fog",{attach:"fog",args:[e?"#000000":"#ffffff",20,40]})]})})},ne=typeof window<"u";function $s(){const[r,e]=_.useState(()=>ne&&localStorage.getItem("theme")||"light"),[t,s]=_.useState(!1),n=Fe(),[i,a]=_.useState(()=>{if(!ne)return!1;const b=sessionStorage.getItem("hasSeenIntro");return n.pathname==="/"&&!b}),[l,c]=_.useState(!1);Ns(!i);const{isTransitioning:u,startPosition:d,triggerThemeTransition:h,completeTransition:g}=Cs(b=>{e(b||(r==="light"?"dark":"light"))}),f=b=>{h(b)},p=()=>{ne&&(sessionStorage.setItem("hasSeenIntro","true"),a(!1),c(!0))};_.useEffect(()=>{ne&&window.scrollTo(0,0)},[]),_.useLayoutEffect(()=>{if(!ne)return;const b=window.document.documentElement;r==="dark"?b.classList.add("dark"):b.classList.remove("dark"),localStorage.setItem("theme",r)},[r]),_.useEffect(()=>{if(ne)return document.body.style.overflow=i?"hidden":"auto",()=>{document.body.style.overflow="auto"}},[i]),_.useEffect(()=>{const b=()=>s(!0);return window.addEventListener("open-calendar-modal",b),()=>window.removeEventListener("open-calendar-modal",b)},[]),_.useEffect(()=>{!i&&!l&&c(!0)},[i,l]);const m={hidden:{y:"100vh",opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",damping:12,stiffness:60,mass:1.2,duration:1.8,delayChildren:.2,staggerChildren:.1}}},w={hidden:{y:50,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",damping:15,stiffness:100,duration:.8}}};return o.jsxs("div",{className:"theme-transition min-h-screen bg-gradient-to-br from-sky-100 via-indigo-100 to-emerald-100 dark:bg-gradient-to-br dark:from-gray-900 dark:via-blue-950 dark:to-gray-900 text-text-light dark:text-text-dark font-body transition-all duration-500",children:[o.jsx(As,{}),o.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:fixed focus:top-4 focus:left-4 focus:z-[200] focus:px-4 focus:py-2 focus:bg-primary-light focus:text-white focus:rounded-lg focus:shadow-lg focus:outline-none",children:"Skip to main content"}),o.jsx(Ps,{theme:r}),o.jsx(V,{mode:"wait",children:i?o.jsx(xs,{onAnimationComplete:p},"intro"):o.jsxs(v.div,{variants:m,initial:"hidden",animate:l?"visible":"hidden",className:"min-h-screen relative z-20",children:[o.jsx(Es,{}),o.jsx(v.div,{variants:w,children:o.jsx(bs,{theme:r,onThemeSwitch:f})}),o.jsx("main",{id:"main-content",className:"min-h-screen",children:o.jsx(V,{mode:"wait",children:o.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,ease:[.25,.46,.45,.94]},className:"min-h-full",children:o.jsx(Mr,{})},n.pathname)})}),o.jsx(v.div,{variants:w,children:o.jsx(vs,{onClick:()=>s(!0)})}),o.jsx(v.div,{variants:w,children:o.jsx(_s,{isOpen:t,onClose:()=>s(!1),theme:r})}),o.jsx(v.div,{variants:w,children:o.jsx(Ss,{})}),o.jsx(v.div,{variants:w,children:o.jsx(ks,{})})]},"main-content")}),o.jsx(js,{isActive:u,onComplete:g,startPosition:d,theme:r})]})}class Us extends H.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("Error Boundary caught an error:",e,t),N("error_boundary_triggered","Error",`${e.name}: ${e.message}`),this.setState({error:e,errorInfo:t})}handleRefresh=()=>{N("error_boundary_refresh","Error","User clicked refresh after error"),window.location.reload()};handleGoHome=()=>{N("error_boundary_home","Error","User clicked go home after error"),window.location.href="/"};render(){return this.state.hasError?o.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark flex items-center justify-center px-4",children:o.jsxs("div",{className:"max-w-md w-full text-center",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx(Jr,{size:64,className:"mx-auto text-red-500 mb-4"}),o.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Oops! Something went wrong"}),o.jsx("p",{className:"text-text-light dark:text-text-dark",children:"Don't worry, it's not you - it's us. Let's get you back on track."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{onClick:this.handleRefresh,className:"w-full flex items-center justify-center gap-2 bg-primary-light text-white font-bold py-3 px-6 rounded-lg hover:bg-opacity-90 transition-all",children:[o.jsx(Yr,{size:20}),"Refresh Page"]}),o.jsxs("button",{onClick:this.handleGoHome,className:"w-full flex items-center justify-center gap-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-300 font-bold py-3 px-6 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-all",children:[o.jsx(cr,{size:20}),"Go to Homepage"]})]}),!1]})}):this.props.children}}const Rt=()=>o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"flex flex-col items-center gap-4",children:[o.jsx("div",{className:"w-8 h-8 border-2 border-primary-light dark:border-primary-dark border-t-transparent rounded-full animate-spin"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Loading..."})]})}),hr=[.25,.25,0,1],fr=[.34,1.56,.64,1],Re={initial:{opacity:0,scale:.85,y:0},animate:{opacity:1,scale:1,y:0,transition:{duration:.8,ease:fr,staggerChildren:.12,delayChildren:.2}},exit:{opacity:0,scale:.9,transition:{duration:.4,ease:hr}}},gr={hidden:{opacity:0},visible:{opacity:1,transition:{delayChildren:.2,staggerChildren:.1}}},ve={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:hr}}},Ct={initial:{opacity:0,scale:.9,y:0},animate:{opacity:1,scale:1,y:0,transition:{duration:.6,ease:fr}}},Nt=["Efficiency","Clarity","Impact","Trust","Solutions"],It="01/>_<!?-+X",Ls=({text:r})=>{const[e,t]=_.useState(r);return _.useEffect(()=>{let s,n=0;return clearInterval(s),s=setInterval(()=>{t(()=>r.split("").map((i,a)=>a<Math.floor(n)?r[a]:It[Math.floor(Math.random()*It.length)]).join("")),n>=r.length&&clearInterval(s),n+=.5},50),()=>clearInterval(s)},[r]),o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"sr-only",children:r}),o.jsx("span",{"aria-hidden":"true",className:"font-mono text-primary-light dark:text-primary-dark inline-block min-w-[200px] text-left",children:e})]})},Ds=()=>{const[r,e]=_.useState(0);return _.useEffect(()=>{const t=setInterval(()=>{e(s=>(s+1)%Nt.length)},3e3);return()=>clearInterval(t)},[]),o.jsx("section",{id:"hero",className:"relative min-h-screen flex items-center justify-center px-4 overflow-hidden",children:o.jsxs(v.div,{variants:gr,initial:"hidden",animate:"visible",className:"relative z-20 max-w-5xl mx-auto text-center w-full",children:[o.jsx(v.div,{variants:ve,className:"mb-10 flex justify-center",children:o.jsxs("div",{className:"inline-flex items-center gap-3 px-5 py-2.5 rounded-full bg-white/10 dark:bg-black/20 backdrop-blur-md border border-primary-light/20 dark:border-primary-dark/20 shadow-[0_0_20px_rgba(59,130,246,0.15)] group hover:border-primary-light/50 transition-colors cursor-default",children:[o.jsxs("span",{className:"relative flex h-2.5 w-2.5",children:[o.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),o.jsx("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-green-500"})]}),o.jsx("span",{className:"text-xs font-bold tracking-widest text-primary-light dark:text-primary-dark uppercase group-hover:text-white transition-colors",children:"Suiting Up @ Cognizant"})]})}),o.jsxs(v.div,{variants:ve,className:"font-heading text-5xl sm:text-6xl md:text-7xl lg:text-8xl font-bold tracking-tight mb-8 leading-none text-gray-900 dark:text-white",children:[o.jsx("div",{className:"mb-2",children:"I Engineer"}),o.jsxs("div",{className:"h-[1.3em] relative flex justify-center items-center",children:[o.jsx(Ls,{text:Nt[r]}),o.jsx(v.span,{animate:{opacity:[0,1,0]},transition:{duration:.8,repeat:1/0},className:"inline-block w-1.5 h-10 sm:h-14 ml-1 bg-primary-light dark:bg-primary-dark align-middle"})]})]}),o.jsxs(v.div,{variants:ve,className:"max-w-4xl mx-auto space-y-6 mt-8",children:[o.jsxs("p",{className:"text-lg md:text-xl text-gray-600 dark:text-gray-400 leading-relaxed font-medium",children:["Technical Consultant at ",o.jsx("span",{className:"text-gray-900 dark:text-white font-bold",children:"Cognizant (Measurement CoE)"}),".",o.jsx("br",{className:"hidden md:block"}),"I troubleshoot high-stakes setups for ",o.jsx("span",{className:"text-gray-900 dark:text-white font-bold",children:"Google Ads, GTM, GA4, & Firebase"}),". If the tracking isn't right, the ROI isn't real."]}),o.jsxs("p",{className:"text-lg md:text-xl text-gray-600 dark:text-gray-400 leading-relaxed font-medium",children:["Aspiring ",o.jsx("span",{className:"bg-gradient-to-r from-purple-500 to-pink-500 bg-clip-text text-transparent font-bold",children:"Product Manager"})," - because after fixing thousands of broken implementations, I know how to build a product that actually works."]}),o.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 italic mt-6 opacity-80",children:"(It’s going to be legen... wait for it.... dary)"})]})]})})},Bs=[{chapter:"Chapter 1",title:"Graduation",subtitle:"B.Com, Acharya Institute",story:"Graduated with a B.Com degree. Honestly? I was clueless. No clear direction, just going with the flow. I started working because that's what you do after graduation.",quote:"Fun fact: I had zero plans. But hey, improvisation is a skill too.",icon:Xr,accent:"text-blue-500"},{chapter:"Chapter 2",title:"The Start",subtitle:"BPO & Customer Support",story:"Landed a tech support role for OnePlus. For the first time, I felt something click. I was working with technology, and I loved it. I didn't know exactly what 'more' looked like, but I knew I had to move toward it.",quote:"Tech support taught me one thing: people break things creatively.",icon:Qr,accent:"text-purple-500"},{chapter:"Chapter 3",title:"The Shift",subtitle:"Digital Marketing & Analytics",story:"Moved to Regalix. Digital marketing meets technology: Google Ads, Analytics, Tag Manager. I wasn't just learning. I was genuinely liking playing with data.",quote:"Turns out, I like playing with data more than I thought.",icon:nt,accent:"text-orange-500"},{chapter:"Chapter 4",title:"The 'Aha!' Moment",subtitle:"Automation Tool",story:"I automated a manual task that 100+ people were doing daily. When it finally worked, something clicked. I wasn't just solving a problem. I'd discovered what I actually wanted to do: build things.",quote:"Why work harder when you can code smarter?",icon:Zr,accent:"text-yellow-500"},{chapter:"Chapter 5",title:"This Portfolio",subtitle:"From Idea to Reality",story:"I wanted to showcase my resume as a website. I learned React and Tailwind CSS from scratch to build this. Every animation, every transition: built by me.",quote:"Templates were always there. I wanted to build it from scratch.",icon:es,accent:"text-cyan-500"},{chapter:"Chapter 6",title:"Building Pluto",subtitle:"Full-Stack Finance App",story:"I built Pluto, a personal finance app using Flutter & Firebase. UI design, backend logic, databases... I figured it out. That's when it hit me: I could actually build real products.",quote:"I Googled my way through this. No shame.",icon:ts,accent:"text-indigo-500"},{chapter:"Chapter 7",title:"The Goal",subtitle:"Product Management",story:"I know what users need, what data tells us, and what it takes to actually ship a product. I don't just want to manage products. I want to build ones that actually matter.",quote:"I've done the grunt work. Now let me call the shots.",icon:ur,accent:"text-emerald-500"},{chapter:"To Be Continued...",title:"Next Chapter",subtitle:"The journey is far from over.",story:"Suit up, because the journey is far from over. I've got some serious plays lined up. All I know is it's gonna be legendary, so let's wait for it.",quote:"I'm like a shark. If I stop moving forward, I die.",icon:dr,accent:"text-rose-500"}],Ms=()=>o.jsxs("section",{id:"about",className:"relative w-full pt-20 pb-24 px-4 md:px-8",children:[o.jsx("div",{className:"text-center mb-16 max-w-4xl mx-auto",children:o.jsx(v.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},children:o.jsxs("h2",{className:"font-heading text-4xl md:text-5xl mb-4",children:[o.jsx("span",{className:"text-text-light dark:text-text-dark",children:"My "}),o.jsx("span",{className:"bg-gradient-to-r from-primary-light to-accent-green-light dark:from-primary-dark dark:to-accent-green-dark bg-clip-text text-transparent",children:"Journey"})]})})}),o.jsx("div",{className:"max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 relative z-10",children:Bs.map((r,e)=>{const t=r.icon;return o.jsx(v.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:e*.1},viewport:{once:!0,margin:"-50px"},className:"h-full",children:o.jsxs(v.div,{className:"h-full flex flex-col p-6 rounded-2xl bg-white/40 dark:bg-black/40 backdrop-blur-xl border border-white/40 dark:border-white/10 shadow-lg hover:shadow-xl transition-all duration-300 group",whileHover:{y:-5},children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsx("div",{className:`p-3 rounded-xl bg-white/50 dark:bg-white/5 border border-white/20 dark:border-white/10 ${r.accent}`,children:o.jsx(t,{size:24})}),o.jsxs("span",{className:"text-xs font-mono font-bold text-gray-500 dark:text-gray-400 opacity-60",children:["0",e+1]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("h3",{className:"font-heading text-xl font-bold text-gray-900 dark:text-white mb-1",children:r.title}),o.jsx("p",{className:"text-sm font-medium text-primary-light dark:text-primary-dark opacity-90",children:r.subtitle})]}),o.jsx("p",{className:"text-sm leading-relaxed text-gray-700 dark:text-gray-300 mb-6 flex-grow",children:r.story}),o.jsx("div",{className:"pt-4 border-t border-gray-200/50 dark:border-gray-700/50",children:o.jsxs("p",{className:"text-xs italic text-gray-500 dark:text-gray-400",children:['"',r.quote,'"']})})]})},e)})})]}),me=H.forwardRef(({variant:r="primary",size:e="md",align:t="center",children:s,className:n="",disabled:i=!1,asLink:a=!1,href:l="#",target:c=void 0,rel:u=void 0,onClick:d=void 0,type:h="button",...g},f)=>{const p={sm:"px-4 py-2 text-sm",md:"px-6 py-3 text-base",lg:"px-8 py-4 text-lg",icon:"p-3 rounded-full"},m={primary:`
      bg-gradient-to-r from-primary-light to-accent-green-light 
      dark:from-primary-dark dark:to-accent-green-dark 
      text-white font-semibold
      hover:shadow-lg hover:shadow-primary-light/30 dark:hover:shadow-primary-dark/30
      disabled:opacity-60 disabled:cursor-not-allowed
      transition-all duration-300
    `,secondary:`
      bg-white/28 dark:bg-black/24 
      backdrop-blur-3xl backdrop-saturate-150 
      border border-transparent
      text-text-light dark:text-text-dark
      hover:bg-white/40 dark:hover:bg-black/35
      hover:shadow-md
      disabled:opacity-60 disabled:cursor-not-allowed
      transition-all duration-300
    `,tertiary:`
      bg-transparent
      border-2 border-gray-300 dark:border-gray-600
      text-text-light dark:text-text-dark
      hover:border-primary-light dark:hover:border-primary-dark
      hover:text-primary-light dark:hover:text-primary-dark
      disabled:opacity-60 disabled:cursor-not-allowed
      transition-all duration-300
    `,ghost:`
      bg-transparent
      text-text-light dark:text-text-dark
      relative
      hover:text-primary-light dark:hover:text-primary-dark
      after:content-['']
      after:absolute
      after:bottom-0
      after:left-0
      after:w-0
      after:h-0.5
      after:bg-primary-light
      dark:after:bg-primary-dark
      after:transition-all
      after:duration-300
      hover:after:w-full
      disabled:opacity-60 disabled:cursor-not-allowed
      transition-all duration-300
    `},x=`
    inline-flex items-center
    gap-2 font-medium rounded-lg
    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-light dark:focus:ring-primary-dark
    transition-all duration-300
   ${t==="start"?"justify-start":t==="end"?"justify-end":t==="between"?"justify-between":"justify-center"} ${p[e]||p.md} ${m[r]||m.primary} ${n}`;return a?o.jsx(v.a,{ref:f,href:l,target:c,rel:u,onClick:d,whileHover:i?{}:{scale:1.02,y:-1},whileTap:i?{}:{scale:.98},className:x,...g,children:s}):o.jsx(v.button,{ref:f,type:h,disabled:i,onClick:d,whileHover:i?{}:{scale:1.02,y:-1},whileTap:i?{}:{scale:.98},className:x,...g,children:s})});me.displayName="Button";const qs=()=>{H.useEffect(()=>{pe("Projects Page","projects")},[]);const r=[{id:"automation",title:"Team-Wide Automation",icon:ss,description:"A Google Apps Script solution that eliminated 45 mins of manual data entry per day for 120+ people.",problem:"Team leads were wasting 30+ mins daily manually copying data between sheets.",build:"Architected a fully automated sync system using Google Apps Script & Sheets API that runs while they sleep.",outcome:"Adopted by 10+ teams. 100% adoption rate. Zero manual intervention required.",metrics:[{icon:Tt,value:"10+",label:"Teams"},{icon:Ke,value:"45m",label:"Saved/Day"},{icon:rs,value:"100%",label:"Adoption"}],techStack:["Apps Script","JavaScript","Sheets API"],accent:"text-blue-500",glow:"shadow-blue-500/20"},{id:"pluto",title:"Pluto Finance",icon:dr,description:"A privacy-first, offline-capable finance tracker built with Flutter & Firebase.",problem:"Existing apps were either too expensive, privacy-invasive, or required constant internet.",build:"Engineered a local-first architecture with background sync. Works perfectly in airplane mode.",outcome:"My daily driver for finances. Fast, private, and zero subscription costs.",metrics:[{icon:Tt,value:"Daily",label:"Usage"},{icon:nt,value:"100%",label:"Offline"},{icon:Ke,value:"<1s",label:"Load"}],techStack:["Flutter","Firebase","Dart"],links:[{type:"internal",label:"View Project",url:"/pluto",icon:or}],accent:"text-purple-500",glow:"shadow-purple-500/20"},{id:"portfolio",title:"This Portfolio",icon:is,description:"A high-performance React application showcasing modern UI/UX principles.",problem:"Needed a home on the web that wasn't just another generic template.",build:"Built from scratch with React, Tailwind, and Framer Motion. Focused on micro-interactions.",outcome:"You are looking at it! A 100% responsive, dark-mode enabled 3D experience.",metrics:[{icon:nt,value:"99",label:"Perform."},{icon:ns,value:"100%",label:"Resp."},{icon:Ke,value:"0.5s",label:"Load"}],techStack:["React","Tailwind","Framer"],accent:"text-emerald-500",glow:"shadow-emerald-500/20"}];return o.jsx("div",{className:"min-h-screen pt-28 pb-24 px-4 md:px-8 relative z-10",children:o.jsxs("section",{className:"max-w-6xl mx-auto",children:[o.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-20",children:[o.jsxs("h1",{className:"font-heading text-4xl md:text-6xl mb-4 text-gray-900 dark:text-white",children:["My ",o.jsx("span",{className:"bg-gradient-to-r from-primary-light to-accent-green-light dark:from-primary-dark dark:to-accent-green-dark bg-clip-text text-transparent",children:"Projects"})]}),o.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto",children:"Solutions engineered to address real-world inefficiencies and deliver measurable impact."})]}),o.jsx("div",{className:"grid grid-cols-1 gap-12",children:r.map((e,t)=>{const s=e.icon;return o.jsx(v.div,{initial:{opacity:0,y:40},whileInView:{opacity:1,y:0},viewport:{once:!0,margin:"-100px"},transition:{duration:.6,delay:t*.1},className:"relative",children:o.jsx("div",{className:"rounded-3xl bg-white/40 dark:bg-black/40 backdrop-blur-xl border border-white/40 dark:border-white/10 shadow-xl overflow-hidden group hover:border-white/60 dark:hover:border-white/20 transition-colors duration-500",children:o.jsxs("div",{className:"grid lg:grid-cols-12 gap-0",children:[o.jsxs("div",{className:"lg:col-span-5 p-8 border-b lg:border-b-0 lg:border-r border-white/20 dark:border-white/5 flex flex-col justify-between bg-white/20 dark:bg-white/5",children:[o.jsxs("div",{children:[o.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center mb-6 bg-white dark:bg-gray-800 shadow-lg ${e.accent}`,children:o.jsx(s,{size:28})}),o.jsx("div",{className:"grid grid-cols-3 gap-4 mb-8",children:e.metrics.map((n,i)=>o.jsxs("div",{className:"text-center p-3 rounded-xl bg-white/40 dark:bg-black/20 border border-white/20 dark:border-white/5",children:[o.jsx(n.icon,{size:16,className:`mx-auto mb-2 ${e.accent} opacity-80`}),o.jsx("div",{className:"font-bold text-gray-900 dark:text-white",children:n.value}),o.jsx("div",{className:"text-[10px] uppercase tracking-wider text-gray-500 dark:text-gray-400",children:n.label})]},i))})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:e.techStack.map(n=>o.jsx("span",{className:"px-3 py-1 text-xs font-medium rounded-full bg-white/60 dark:bg-white/10 border border-white/20 text-gray-700 dark:text-gray-300",children:n},n))})]}),o.jsxs("div",{className:"lg:col-span-7 p-8 md:p-10 flex flex-col justify-center",children:[o.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4 group-hover:text-primary-light dark:group-hover:text-primary-dark transition-colors",children:e.title}),o.jsx("p",{className:"text-lg text-gray-700 dark:text-gray-300 mb-8 leading-relaxed",children:e.description}),o.jsxs("div",{className:"space-y-6 mb-8",children:[o.jsxs("div",{className:"flex gap-4",children:[o.jsx("div",{className:`mt-1.5 w-1.5 h-1.5 rounded-full flex-shrink-0 ${e.accent.replace("text","bg")}`}),o.jsxs("div",{children:[o.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-gray-500 dark:text-gray-400 block mb-1",children:"Problem"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:e.problem})]})]}),o.jsxs("div",{className:"flex gap-4",children:[o.jsx("div",{className:`mt-1.5 w-1.5 h-1.5 rounded-full flex-shrink-0 ${e.accent.replace("text","bg")}`}),o.jsxs("div",{children:[o.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-gray-500 dark:text-gray-400 block mb-1",children:"Solution"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:e.build})]})]})]}),e.links&&o.jsx("div",{className:"flex gap-4",children:e.links.map((n,i)=>o.jsxs(yt,{to:n.url,className:`inline-flex items-center gap-2 px-6 py-3 rounded-xl bg-gray-900 dark:bg-white text-white dark:text-gray-900 font-bold hover:gap-3 transition-all ${e.glow}`,children:[n.label," ",o.jsx(n.icon,{size:18})]},i))})]})]})})},e.id)})}),o.jsx(v.div,{initial:{opacity:0},whileInView:{opacity:1},transition:{delay:.2},className:"mt-24 text-center",children:o.jsx("div",{className:"inline-block p-1 rounded-full bg-gradient-to-r from-gray-200 to-gray-300 dark:from-gray-800 dark:to-gray-700",children:o.jsx(me,{asLink:!0,href:"mailto:mahanadhip@gmail.com",variant:"secondary",className:"rounded-full px-8 bg-white dark:bg-gray-900 border-none",children:"Let's build something new together"})})})]})})},Fs=[{name:"AI-Assisted Dev",level:"Advanced",description:"Leveraging AI to build faster than humanly possible.",accent:"bg-blue-500"},{name:"Problem First",level:"Strong",description:"Finding the real issue before writing a single line of code.",accent:"bg-purple-500"},{name:"Velocity",level:"High",description:"Shipping working solutions over perfect architecture.",accent:"bg-green-500"},{name:"Outcome Focus",level:"Strong",description:"Measuring success by impact, not lines of code.",accent:"bg-orange-500"}],zs=[{name:"React & JS",level:"Learning",description:"Building functional apps with heavy AI assistance.",accent:"bg-cyan-500"},{name:"Flutter",level:"Learning",description:"Cross-platform mobile development for real apps.",accent:"bg-blue-500"},{name:"Apps Script",level:"Pro",description:"Automating enterprise workflows at scale.",accent:"bg-yellow-500"},{name:"Firebase",level:"Comfortable",description:"Backend-as-a-Service for quick deployments.",accent:"bg-orange-500"}],Vs=[{name:"Cursor / VS Code",level:"Daily Driver",accent:"bg-blue-500"},{name:"ChatGPT / Claude",level:"Primary",accent:"bg-purple-500"},{name:"GitHub Copilot",level:"Assistant",accent:"bg-gray-500"},{name:"Perplexity",level:"Research",accent:"bg-teal-500"}],Ws=[{name:"Google Analytics",level:"Expert",description:"Setup, analysis, and custom reporting.",accent:"bg-orange-500"},{name:"GTM",level:"Expert",description:"Complex event tracking and data layers.",accent:"bg-blue-500"},{name:"Google Ads",level:"Expert",description:"Conversion tracking & attribution modeling.",accent:"bg-green-500"},{name:"Looker Studio",level:"Proficient",description:"Visualizing data for stakeholders.",accent:"bg-indigo-500"}],Ce=({skill:r,index:e})=>o.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:e*.05},className:"group relative p-5 rounded-2xl bg-white/30 dark:bg-black/30 backdrop-blur-md border border-white/20 dark:border-white/10 shadow-lg hover:bg-white/40 dark:hover:bg-white/5 transition-all duration-300",children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsx("h3",{className:"font-bold text-gray-900 dark:text-white group-hover:text-primary-light dark:group-hover:text-primary-dark transition-colors",children:r.name}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-[10px] uppercase font-bold text-gray-500 dark:text-gray-400 tracking-wider",children:r.level}),o.jsxs("div",{className:"relative flex h-2.5 w-2.5",children:[o.jsx("span",{className:`animate-ping absolute inline-flex h-full w-full rounded-full opacity-75 ${r.accent}`}),o.jsx("span",{className:`relative inline-flex rounded-full h-2.5 w-2.5 ${r.accent}`})]})]})]}),r.description&&o.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed opacity-90",children:r.description})]}),Pt=["mindset","technical","ai","analytics"],Ks=()=>{const[r,e]=_.useState("mindset"),t=_.useRef(1);H.useEffect(()=>{pe("Skills Page","skills")},[]);const s=a=>{const l=Pt.indexOf(r),c=Pt.indexOf(a);t.current=c>l?1:-1,e(a)},n=[{id:"mindset",label:"Mindset",icon:as},{id:"technical",label:"Tech Stack",icon:os},{id:"ai",label:"AI Stack",icon:ls},{id:"analytics",label:"Analytics",icon:ur}],i={enter:a=>({x:a*80,opacity:0}),center:{x:0,opacity:1},exit:a=>({x:a*-80,opacity:0})};return o.jsx("div",{className:"min-h-screen pt-28 pb-24 px-4 md:px-8 relative z-10",children:o.jsxs("section",{className:"max-w-5xl mx-auto",children:[o.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-16",children:[o.jsxs("h1",{className:"font-heading text-4xl md:text-6xl mb-4 text-gray-900 dark:text-white",children:["Skills & ",o.jsx("span",{className:"bg-gradient-to-r from-primary-light to-accent-green-light dark:from-primary-dark dark:to-accent-green-dark bg-clip-text text-transparent",children:"Tools"})]}),o.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto",children:"I don't just memorize syntax. I leverage modern tools to solve problems efficiently."})]}),o.jsx("div",{className:"flex justify-center mb-12",children:o.jsx("div",{className:"inline-flex p-1 rounded-2xl bg-white/20 dark:bg-black/20 backdrop-blur-xl border border-white/20 dark:border-white/10 shadow-xl",children:n.map(a=>{const l=a.icon,c=r===a.id;return o.jsxs("button",{onClick:()=>s(a.id),className:`flex items-center gap-2 px-6 py-3 rounded-xl text-sm font-bold transition-all duration-300 ${c?"bg-white dark:bg-gray-800 text-primary-light dark:text-primary-dark shadow-md scale-105":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-white/10"}`,children:[o.jsx(l,{size:18}),o.jsx("span",{className:"hidden sm:inline",children:a.label})]},a.id)})})}),o.jsx("div",{className:"relative mb-12 overflow-hidden",children:o.jsx(V,{mode:"wait",custom:t.current,children:o.jsxs(v.div,{custom:t.current,variants:i,initial:"enter",animate:"center",exit:"exit",transition:{duration:.35,ease:[.25,.46,.45,.94]},className:"grid md:grid-cols-2 gap-4",children:[r==="mindset"&&Fs.map((a,l)=>o.jsx(Ce,{skill:a,index:l},a.name)),r==="technical"&&zs.map((a,l)=>o.jsx(Ce,{skill:a,index:l},a.name)),r==="ai"&&Vs.map((a,l)=>o.jsx(Ce,{skill:a,index:l},a.name)),r==="analytics"&&Ws.map((a,l)=>o.jsx(Ce,{skill:a,index:l},a.name))]},r)})}),o.jsxs(v.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"p-6 rounded-2xl bg-gradient-to-r from-blue-500/10 to-purple-500/10 backdrop-blur-md border border-blue-500/20 text-center",children:[r==="mindset"&&o.jsx("p",{className:"text-gray-700 dark:text-gray-300 italic",children:`"It doesn't have to make sense until it actually does. The how matters less than the doing."`}),r==="technical"&&o.jsx("p",{className:"text-gray-700 dark:text-gray-300 italic",children:'"Perfect code that never ships is just expensive art. Ship it, learn from it, improve it."'}),r==="ai"&&o.jsx("p",{className:"text-gray-700 dark:text-gray-300 italic",children:`"AI is my superpower. It turns 'I don't know how' into 'let me try that' in seconds."`}),r==="analytics"&&o.jsx("p",{className:"text-gray-700 dark:text-gray-300 italic",children:`"Numbers don't lie, but they love to mislead. The real skill is asking the right questions."`})]},r+"-footer")]})})};function ze(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t}function Hs(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(d){try{u(s.next(d))}catch(h){a(h)}}function c(d){try{u(s.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):n(d.value).then(l,c)}u((s=s.apply(r,e||[])).next())})}const Gs=r=>r?(...e)=>r(...e):(...e)=>fetch(...e);class wt extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class Js extends wt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class $t extends wt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ut extends wt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var it;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(it||(it={}));class Ys{constructor(e,{headers:t={},customFetch:s,region:n=it.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=Gs(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Hs(this,arguments,void 0,function*(t,s={}){var n;let i,a;try{const{headers:l,method:c,body:u,signal:d,timeout:h}=s;let g={},{region:f}=s;f||(f=this.region);const p=new URL(`${this.url}/${t}`);f&&f!=="any"&&(g["x-region"]=f,p.searchParams.set("forceFunctionRegion",f));let m;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(g["Content-Type"]="application/octet-stream",m=u):typeof u=="string"?(g["Content-Type"]="text/plain",m=u):typeof FormData<"u"&&u instanceof FormData?m=u:(g["Content-Type"]="application/json",m=JSON.stringify(u)):u&&typeof u!="string"&&!(typeof Blob<"u"&&u instanceof Blob)&&!(u instanceof ArrayBuffer)&&!(typeof FormData<"u"&&u instanceof FormData)?m=JSON.stringify(u):m=u;let w=d;h&&(a=new AbortController,i=setTimeout(()=>a.abort(),h),d?(w=a.signal,d.addEventListener("abort",()=>a.abort())):w=a.signal);const b=yield this.fetch(p.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},g),this.headers),l),body:m,signal:w}).catch(R=>{throw new Js(R)}),x=b.headers.get("x-relay-error");if(x&&x==="true")throw new $t(b);if(!b.ok)throw new Ut(b);let y=((n=b.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),E;return y==="application/json"?E=yield b.json():y==="application/octet-stream"||y==="application/pdf"?E=yield b.blob():y==="text/event-stream"?E=b:y==="multipart/form-data"?E=yield b.formData():E=yield b.text(),{data:E,error:null,response:b}}catch(l){return{data:null,error:l,response:l instanceof Ut||l instanceof $t?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var Xs=class extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}},Qs=class{constructor(r){var e,t;this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=new Headers(r.headers),this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=(e=r.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=r.signal,this.isMaybeSingle=(t=r.isMaybeSingle)!==null&&t!==void 0?t:!1,r.fetch?this.fetch=r.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,e){return this.headers=new Headers(this.headers),this.headers.set(r,e),this}then(r,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let a=null,l=null,c=null,u=i.status,d=i.statusText;if(i.ok){var h,g;if(t.method!=="HEAD"){var f;const b=await i.text();b===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((f=t.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?l=b:l=JSON.parse(b))}const m=(h=t.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),w=(g=i.headers.get("content-range"))===null||g===void 0?void 0:g.split("/");m&&w&&w.length>1&&(c=parseInt(w[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(l)&&(l.length>1?(a={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,u=406,d="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var p;const m=await i.text();try{a=JSON.parse(m),Array.isArray(a)&&i.status===404&&(l=[],a=null,u=200,d="OK")}catch{i.status===404&&m===""?(u=204,d="No Content"):a={message:m}}if(a&&t.isMaybeSingle&&(!(a==null||(p=a.details)===null||p===void 0)&&p.includes("0 rows"))&&(a=null,u=200,d="OK"),a&&t.shouldThrowOnError)throw new Xs(a)}return{error:a,data:l,count:c,status:u,statusText:d}});return this.shouldThrowOnError||(n=n.catch(i=>{var a;let l="";const c=i?.cause;if(c){var u,d,h,g;const p=(u=c?.message)!==null&&u!==void 0?u:"",m=(d=c?.code)!==null&&d!==void 0?d:"";l=`${(h=i?.name)!==null&&h!==void 0?h:"FetchError"}: ${i?.message}`,l+=`

Caused by: ${(g=c?.name)!==null&&g!==void 0?g:"Error"}: ${p}`,m&&(l+=` (${m})`),c?.stack&&(l+=`
${c.stack}`)}else{var f;l=(f=i?.stack)!==null&&f!==void 0?f:""}return{error:{message:`${(a=i?.name)!==null&&a!==void 0?a:"FetchError"}: ${i?.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(r,e)}returns(){return this}overrideTypes(){return this}},Zs=class extends Qs{select(r){let e=!1;const t=(r??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:e=!0,nullsFirst:t,foreignTable:s,referencedTable:n=s}={}){const i=n?`${n}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${r}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:e,referencedTable:t=e}={}){const s=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(s,`${r}`),this}range(r,e,{foreignTable:t,referencedTable:s=t}={}){const n=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${r}`),this.url.searchParams.set(i,`${e-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:e=!1,settings:t=!1,buffers:s=!1,wal:n=!1,format:i="text"}={}){var a;const l=[r?"analyze":null,e?"verbose":null,t?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}};const Lt=new RegExp("[,()]");var he=class extends Zs{eq(r,e){return this.url.searchParams.append(r,`eq.${e}`),this}neq(r,e){return this.url.searchParams.append(r,`neq.${e}`),this}gt(r,e){return this.url.searchParams.append(r,`gt.${e}`),this}gte(r,e){return this.url.searchParams.append(r,`gte.${e}`),this}lt(r,e){return this.url.searchParams.append(r,`lt.${e}`),this}lte(r,e){return this.url.searchParams.append(r,`lte.${e}`),this}like(r,e){return this.url.searchParams.append(r,`like.${e}`),this}likeAllOf(r,e){return this.url.searchParams.append(r,`like(all).{${e.join(",")}}`),this}likeAnyOf(r,e){return this.url.searchParams.append(r,`like(any).{${e.join(",")}}`),this}ilike(r,e){return this.url.searchParams.append(r,`ilike.${e}`),this}ilikeAllOf(r,e){return this.url.searchParams.append(r,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(r,e){return this.url.searchParams.append(r,`ilike(any).{${e.join(",")}}`),this}regexMatch(r,e){return this.url.searchParams.append(r,`match.${e}`),this}regexIMatch(r,e){return this.url.searchParams.append(r,`imatch.${e}`),this}is(r,e){return this.url.searchParams.append(r,`is.${e}`),this}isDistinct(r,e){return this.url.searchParams.append(r,`isdistinct.${e}`),this}in(r,e){const t=Array.from(new Set(e)).map(s=>typeof s=="string"&&Lt.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(r,`in.(${t})`),this}notIn(r,e){const t=Array.from(new Set(e)).map(s=>typeof s=="string"&&Lt.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(r,`not.in.(${t})`),this}contains(r,e){return typeof e=="string"?this.url.searchParams.append(r,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(r,`cs.{${e.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(e)}`),this}containedBy(r,e){return typeof e=="string"?this.url.searchParams.append(r,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(r,`cd.{${e.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(e)}`),this}rangeGt(r,e){return this.url.searchParams.append(r,`sr.${e}`),this}rangeGte(r,e){return this.url.searchParams.append(r,`nxl.${e}`),this}rangeLt(r,e){return this.url.searchParams.append(r,`sl.${e}`),this}rangeLte(r,e){return this.url.searchParams.append(r,`nxr.${e}`),this}rangeAdjacent(r,e){return this.url.searchParams.append(r,`adj.${e}`),this}overlaps(r,e){return typeof e=="string"?this.url.searchParams.append(r,`ov.${e}`):this.url.searchParams.append(r,`ov.{${e.join(",")}}`),this}textSearch(r,e,{config:t,type:s}={}){let n="";s==="plain"?n="pl":s==="phrase"?n="ph":s==="websearch"&&(n="w");const i=t===void 0?"":`(${t})`;return this.url.searchParams.append(r,`${n}fts${i}.${e}`),this}match(r){return Object.entries(r).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(r,e,t){return this.url.searchParams.append(r,`not.${e}.${t}`),this}or(r,{foreignTable:e,referencedTable:t=e}={}){const s=t?`${t}.or`:"or";return this.url.searchParams.append(s,`(${r})`),this}filter(r,e,t){return this.url.searchParams.append(r,`${e}.${t}`),this}},en=class{constructor(r,{headers:e={},schema:t,fetch:s}){this.url=r,this.headers=new Headers(e),this.schema=t,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(r,e){const{head:t=!1,count:s}=e??{},n=t?"HEAD":"GET";let i=!1;const a=(r??"*").split("").map(u=>/\s/.test(u)&&!i?"":(u==='"'&&(i=!i),u)).join(""),{url:l,headers:c}=this.cloneRequestState();return l.searchParams.set("select",a),s&&c.append("Prefer",`count=${s}`),new he({method:n,url:l,headers:c,schema:this.schema,fetch:this.fetch})}insert(r,{count:e,defaultToNull:t=!0}={}){var s;const n="POST",{url:i,headers:a}=this.cloneRequestState();if(e&&a.append("Prefer",`count=${e}`),t||a.append("Prefer","missing=default"),Array.isArray(r)){const l=r.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);i.searchParams.set("columns",c.join(","))}}return new he({method:n,url:i,headers:a,schema:this.schema,body:r,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(r,{onConflict:e,ignoreDuplicates:t=!1,count:s,defaultToNull:n=!0}={}){var i;const a="POST",{url:l,headers:c}=this.cloneRequestState();if(c.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&l.searchParams.set("on_conflict",e),s&&c.append("Prefer",`count=${s}`),n||c.append("Prefer","missing=default"),Array.isArray(r)){const u=r.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);l.searchParams.set("columns",d.join(","))}}return new he({method:a,url:l,headers:c,schema:this.schema,body:r,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(r,{count:e}={}){var t;const s="PATCH",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new he({method:s,url:n,headers:i,schema:this.schema,body:r,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:r}={}){var e;const t="DELETE",{url:s,headers:n}=this.cloneRequestState();return r&&n.append("Prefer",`count=${r}`),new he({method:t,url:s,headers:n,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},tn=class pr{constructor(e,{headers:t={},schema:s,fetch:n}={}){this.url=e,this.headers=new Headers(t),this.schemaName=s,this.fetch=n}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new en(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new pr(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:n=!1,count:i}={}){var a;let l;const c=new URL(`${this.url}/rpc/${e}`);let u;const d=f=>f!==null&&typeof f=="object"&&(!Array.isArray(f)||f.some(d)),h=s&&Object.values(t).some(d);h?(l="POST",u=t):s||n?(l=s?"HEAD":"GET",Object.entries(t).filter(([f,p])=>p!==void 0).map(([f,p])=>[f,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([f,p])=>{c.searchParams.append(f,p)})):(l="POST",u=t);const g=new Headers(this.headers);return h?g.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&g.set("Prefer",`count=${i}`),new he({method:l,url:c,headers:g,schema:this.schemaName,body:u,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};class rn{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const s=t.versions;if(s&&s.node){const n=s.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const sn="2.90.1",nn=`realtime-js/${sn}`,mr="1.0.0",an="2.0.0",Dt=mr,at=1e4,on=1e3,ln=100;var Y;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Y||(Y={}));var $;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})($||($={}));var z;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(z||(z={}));var ot;(function(r){r.websocket="websocket"})(ot||(ot={}));var te;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(te||(te={}));class cn{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,s;const n=(s=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var t,s;const n=(s=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&s!==void 0?s:{},a=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,t,s){var n,i;const a=e.topic,l=(n=e.ref)!==null&&n!==void 0?n:"",c=(i=e.join_ref)!==null&&i!==void 0?i:"",u=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(d).length===0?"":JSON.stringify(d);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const g=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+a.length+u.length+h.length,f=new ArrayBuffer(this.HEADER_LENGTH+g);let p=new DataView(f),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,c.length),p.setUint8(m++,l.length),p.setUint8(m++,a.length),p.setUint8(m++,u.length),p.setUint8(m++,h.length),p.setUint8(m++,t),Array.from(c,b=>p.setUint8(m++,b.charCodeAt(0))),Array.from(l,b=>p.setUint8(m++,b.charCodeAt(0))),Array.from(a,b=>p.setUint8(m++,b.charCodeAt(0))),Array.from(u,b=>p.setUint8(m++,b.charCodeAt(0))),Array.from(h,b=>p.setUint8(m++,b.charCodeAt(0)));var w=new Uint8Array(f.byteLength+s.byteLength);return w.set(new Uint8Array(f),0),w.set(new Uint8Array(s),f.byteLength),w.buffer}decode(e,t){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return t(s)}if(typeof e=="string"){const s=JSON.parse(e),[n,i,a,l,c]=s;return t({join_ref:n,ref:i,topic:a,event:l,payload:c})}return t({})}_binaryDecode(e){const t=new DataView(e),s=t.getUint8(0),n=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,n)}}_decodeUserBroadcast(e,t,s){const n=t.getUint8(1),i=t.getUint8(2),a=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+4;const u=s.decode(e.slice(c,c+n));c=c+n;const d=s.decode(e.slice(c,c+i));c=c+i;const h=s.decode(e.slice(c,c+a));c=c+a;const g=e.slice(c,e.byteLength),f=l===this.JSON_ENCODING?JSON.parse(s.decode(g)):g,p={type:this.BROADCAST_EVENT,event:d,payload:f};return a>0&&(p.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>t.includes(s)))}}class yr{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var O;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(O||(O={}));const Bt=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,a)=>(i[a]=un(a,r,e,n),i),{}):{}},un=(r,e,t,s)=>{const n=e.find(l=>l.name===r),i=n?.type,a=t[r];return i&&!s.includes(i)?wr(i,a):lt(a)},wr=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return gn(e,t)}switch(r){case O.bool:return dn(e);case O.float4:case O.float8:case O.int2:case O.int4:case O.int8:case O.numeric:case O.oid:return hn(e);case O.json:case O.jsonb:return fn(e);case O.timestamp:return pn(e);case O.abstime:case O.date:case O.daterange:case O.int4range:case O.int8range:case O.money:case O.reltime:case O.text:case O.time:case O.timestamptz:case O.timetz:case O.tsrange:case O.tstzrange:return lt(e);default:return lt(e)}},lt=r=>r,dn=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},hn=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},fn=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch{return r}return r},gn=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let i;const a=r.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(l=>wr(e,l))}return r},pn=r=>typeof r=="string"?r.replace(" ","T"):r,br=r=>{const e=new URL(r);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Ge{constructor(e,t,s={},n=at){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Mt;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Mt||(Mt={}));class _e{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=_e.syncState(this.state,n,i,a),this.pendingDiffs.forEach(c=>{this.state=_e.syncDiff(this.state,c,i,a)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=_e.syncDiff(this.state,n,i,a),l())}),this.onJoin((n,i,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:a})}),this.onLeave((n,i,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const i=this.cloneDeep(e),a=this.transformState(t),l={},c={};return this.map(i,(u,d)=>{a[u]||(c[u]=d)}),this.map(a,(u,d)=>{const h=i[u];if(h){const g=d.map(w=>w.presence_ref),f=h.map(w=>w.presence_ref),p=d.filter(w=>f.indexOf(w.presence_ref)<0),m=h.filter(w=>g.indexOf(w.presence_ref)<0);p.length>0&&(l[u]=p),m.length>0&&(c[u]=m)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},s,n)}static syncDiff(e,t,s,n){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),d.length>0){const h=e[l].map(f=>f.presence_ref),g=d.filter(f=>h.indexOf(f.presence_ref)<0);e[l].unshift(...g)}s(l,d,c)}),this.map(a,(l,c)=>{let u=e[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=u,n(l,u,c),u.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var qt;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(qt||(qt={}));var xe;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(xe||(xe={}));var K;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(K||(K={}));class ye{constructor(e,t={config:{}},s){var n,i;if(this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=$.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Ge(this,z.join,this.params,this.timeout),this.rejoinTimer=new yr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=$.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=$.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=$.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=$.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=$.errored,this.rejoinTimer.scheduleTimeout())}),this._on(z.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new _e(this),this.broadcastEndpointURL=br(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var s,n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==$.closed){const{config:{broadcast:a,presence:l,private:c}}=this.params,u=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(f=>f.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[xe.PRESENCE]&&this.bindings[xe.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},g={broadcast:a,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(f=>e?.(K.CHANNEL_ERROR,f)),this._onClose(()=>e?.(K.CLOSED)),this.updateJoinPayload(Object.assign({config:g},h)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:f})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),f===void 0){e?.(K.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,w=(p=m?.length)!==null&&p!==void 0?p:0,b=[];for(let x=0;x<w;x++){const y=m[x],{filter:{event:E,schema:R,table:T,filter:A}}=y,J=f&&f[x];if(J&&J.event===E&&ye.isFilterValueEqual(J.schema,R)&&ye.isFilterValueEqual(J.table,T)&&ye.isFilterValueEqual(J.filter,A))b.push(Object.assign(Object.assign({},y),{id:J.id}));else{this.unsubscribe(),this.state=$.errored,e?.(K.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,e&&e(K.SUBSCRIBED);return}}).receive("error",f=>{this.state=$.errored,e?.(K.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e?.(K.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===$.joined&&e===xe.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,s)}async httpSend(e,t,s={}){var n;if(t==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:a}=e,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,l,c;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=$.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(z.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new Ge(this,z.leave,{},e),s.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=$.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Ge(this,e,t,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>ln){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,i;const a=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=z;if(s&&[l,c,u,d].indexOf(a)>=0&&s!==this._joinRef())return;let g=this._onMessage(a,t,s);if(t&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var p,m,w;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((w=(m=f.filter)===null||m===void 0?void 0:m.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===a}).map(f=>f.callback(g,s)):(i=this.bindings[a])===null||i===void 0||i.filter(f=>{var p,m,w,b,x,y,E,R;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const T=f.id,A=(p=f.filter)===null||p===void 0?void 0:p.event;return T&&((m=t.ids)===null||m===void 0?void 0:m.includes(T))&&(A==="*"||A?.toLocaleLowerCase()===((w=t.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))&&(!(!((b=f.filter)===null||b===void 0)&&b.table)||f.filter.table===((x=t.data)===null||x===void 0?void 0:x.table))}else{const T=(E=(y=f?.filter)===null||y===void 0?void 0:y.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return T==="*"||T===((R=t?.event)===null||R===void 0?void 0:R.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof g=="object"&&"ids"in g){const p=g.data,{schema:m,table:w,commit_timestamp:b,type:x,errors:y}=p;g=Object.assign(Object.assign({},{schema:m,table:w,commit_timestamp:b,eventType:x,new:{},old:{},errors:y}),this._getPayloadRecords(p))}f.callback(g,s)})}_isClosed(){return this.state===$.closed}_isJoined(){return this.state===$.joined}_isJoining(){return this.state===$.joining}_isLeaving(){return this.state===$.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&ye.isEqual(n.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(z.close,{},e)}_onError(e){this._on(z.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=$.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Bt(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Bt(e.columns,e.old_record)),t}}const Je=()=>{},Ne={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},mn=[1e3,2e3,5e3,1e4],yn=1e4,wn=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class bn{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=at,this.transport=null,this.heartbeatIntervalMs=Ne.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Je,this.ref=0,this.reconnectTimer=null,this.vsn=Dt,this.logger=Je,this.conn=null,this.sendBuffer=[],this.serializer=new cn,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),!(!((s=t?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${ot.websocket}`,this.httpEndpoint=br(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=rn.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Y.connecting:return te.Connecting;case Y.open:return te.Open;case Y.closing:return te.Closing;default:return te.Closed}}isConnected(){return this.connectionState()===te.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new ye(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:s,payload:n,ref:i}=e,a=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${s} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(on,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Ne.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const u=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",u)}catch(d){this.log("error","error in heartbeat callback",d)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:n,payload:i,ref:a}=t,l=a?`(${a})`:"",c=i.status||"";this.log("receive",`${c} ${s} ${n} ${l}`.trim(),i),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(n,i,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Y.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Y.open||this.conn.readyState===Y.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(z.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([wn],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,s=!1;if(e)t=e,s=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),t=this.accessTokenValue}else t=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const i={access_token:t,version:nn};t&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(z.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new yr(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ne.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,n,i,a,l,c,u,d,h,g,f;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e?.timeout)!==null&&s!==void 0?s:at,this.heartbeatIntervalMs=(n=e?.heartbeatIntervalMs)!==null&&n!==void 0?n:Ne.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e?.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:Je,this.vsn=(c=e?.vsn)!==null&&c!==void 0?c:Dt,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e?.reconnectAfterMs)!==null&&u!==void 0?u:p=>mn[p-1]||yn,this.vsn){case mr:this.encode=(d=e?.encode)!==null&&d!==void 0?d:(p,m)=>m(JSON.stringify(p)),this.decode=(h=e?.decode)!==null&&h!==void 0?h:(p,m)=>m(JSON.parse(p));break;case an:this.encode=(g=e?.encode)!==null&&g!==void 0?g:this.serializer.encode.bind(this.serializer),this.decode=(f=e?.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var ke=class extends Error{constructor(r,e){super(r),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function vn(r,e,t){const s=new URL(e,r);if(t)for(const[n,i]of Object.entries(t))i!==void 0&&s.searchParams.set(n,i);return s.toString()}async function _n(r){return!r||r.type==="none"?{}:r.type==="bearer"?{Authorization:`Bearer ${r.token}`}:r.type==="header"?{[r.name]:r.value}:r.type==="custom"?await r.getHeaders():{}}function xn(r){const e=r.fetchImpl??globalThis.fetch;return{async request({method:t,path:s,query:n,body:i,headers:a}){const l=vn(r.baseUrl,s,n),c=await _n(r.auth),u=await e(l,{method:t,headers:{...i?{"Content-Type":"application/json"}:{},...c,...a},body:i?JSON.stringify(i):void 0}),d=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),g=h&&d?JSON.parse(d):d;if(!u.ok){const f=h?g:void 0,p=f?.error;throw new ke(p?.message??`Request failed with status ${u.status}`,{status:u.status,icebergType:p?.type,icebergCode:p?.code,details:f})}return{status:u.status,headers:u.headers,data:g}}}}function Ie(r){return r.join("")}var kn=class{constructor(r,e=""){this.client=r,this.prefix=e}async listNamespaces(r){const e=r?{parent:Ie(r.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(r,e){const t={namespace:r.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(r){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ie(r.namespace)}`})}async loadNamespaceMetadata(r){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ie(r.namespace)}`})).data.properties}}async namespaceExists(r){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ie(r.namespace)}`}),!0}catch(e){if(e instanceof ke&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(r,e){try{return await this.createNamespace(r,e)}catch(t){if(t instanceof ke&&t.status===409)return;throw t}}};function ie(r){return r.join("")}var Sn=class{constructor(r,e="",t){this.client=r,this.prefix=e,this.accessDelegation=t}async listTables(r){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ie(r.namespace)}/tables`})).data.identifiers}async createTable(r,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ie(r.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(r,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ie(r.namespace)}/tables/${r.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(r,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ie(r.namespace)}/tables/${r.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(r){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ie(r.namespace)}/tables/${r.name}`,headers:e})).data.metadata}async tableExists(r){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ie(r.namespace)}/tables/${r.name}`,headers:e}),!0}catch(t){if(t instanceof ke&&t.status===404)return!1;throw t}}async createTableIfNotExists(r,e){try{return await this.createTable(r,e)}catch(t){if(t instanceof ke&&t.status===409)return await this.loadTable({namespace:r.namespace,name:e.name});throw t}}},jn=class{constructor(r){let e="v1";r.catalogName&&(e+=`/${r.catalogName}`);const t=r.baseUrl.endsWith("/")?r.baseUrl:`${r.baseUrl}/`;this.client=xn({baseUrl:t,auth:r.auth,fetchImpl:r.fetch}),this.accessDelegation=r.accessDelegation?.join(","),this.namespaceOps=new kn(this.client,e),this.tableOps=new Sn(this.client,e,this.accessDelegation)}async listNamespaces(r){return this.namespaceOps.listNamespaces(r)}async createNamespace(r,e){return this.namespaceOps.createNamespace(r,e)}async dropNamespace(r){await this.namespaceOps.dropNamespace(r)}async loadNamespaceMetadata(r){return this.namespaceOps.loadNamespaceMetadata(r)}async listTables(r){return this.tableOps.listTables(r)}async createTable(r,e){return this.tableOps.createTable(r,e)}async updateTable(r,e){return this.tableOps.updateTable(r,e)}async dropTable(r,e){await this.tableOps.dropTable(r,e)}async loadTable(r){return this.tableOps.loadTable(r)}async namespaceExists(r){return this.namespaceOps.namespaceExists(r)}async tableExists(r){return this.tableOps.tableExists(r)}async createNamespaceIfNotExists(r,e){return this.namespaceOps.createNamespaceIfNotExists(r,e)}async createTableIfNotExists(r,e){return this.tableOps.createTableIfNotExists(r,e)}},Ve=class extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}};function C(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}var En=class extends Ve{constructor(r,e,t){super(r),this.name="StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ct=class extends Ve{constructor(r,e){super(r),this.name="StorageUnknownError",this.originalError=e}};const bt=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),Tn=()=>Response,ut=r=>{if(Array.isArray(r))return r.map(t=>ut(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=ut(s)}),e},An=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},On=r=>!r||typeof r!="string"||r.length===0||r.length>100||r.trim()!==r||r.includes("/")||r.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(r);function Se(r){"@babel/helpers - typeof";return Se=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Se(r)}function Rn(r,e){if(Se(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var s=t.call(r,e);if(Se(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Cn(r){var e=Rn(r,"string");return Se(e)=="symbol"?e:e+""}function Nn(r,e,t){return(e=Cn(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Ft(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,s)}return t}function j(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ft(Object(t),!0).forEach(function(s){Nn(r,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Ft(Object(t)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(t,s))})}return r}const Ye=r=>{var e;return r.msg||r.message||r.error_description||(typeof r.error=="string"?r.error:(e=r.error)===null||e===void 0?void 0:e.message)||JSON.stringify(r)},In=async(r,e,t)=>{r instanceof await Tn()&&!t?.noResolveJson?r.json().then(s=>{const n=r.status||500,i=s?.statusCode||n+"";e(new En(Ye(s),n,i))}).catch(s=>{e(new ct(Ye(s),s))}):e(new ct(Ye(r),r))},Pn=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"||!s?n:(An(s)?(n.headers=j({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(s)):n.body=s,e?.duplex&&(n.duplex=e.duplex),j(j({},n),t))};async function Oe(r,e,t,s,n,i){return new Promise((a,l)=>{r(t,Pn(e,s,n,i)).then(c=>{if(!c.ok)throw c;return s?.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>In(c,l,s))})}async function je(r,e,t,s){return Oe(r,"GET",e,t,s)}async function F(r,e,t,s,n){return Oe(r,"POST",e,s,n,t)}async function dt(r,e,t,s,n){return Oe(r,"PUT",e,s,n,t)}async function $n(r,e,t,s){return Oe(r,"HEAD",e,j(j({},t),{},{noResolveJson:!0}),s)}async function vt(r,e,t,s,n){return Oe(r,"DELETE",e,s,n,t)}var Un=class{constructor(r,e){this.downloadFn=r,this.shouldThrowOnError=e}then(r,e){return this.execute().then(r,e)}async execute(){var r=this;try{return{data:(await r.downloadFn()).body,error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(C(e))return{data:null,error:e};throw e}}};let vr;vr=Symbol.toStringTag;var Ln=class{constructor(r,e){this.downloadFn=r,this.shouldThrowOnError=e,this[vr]="BlobDownloadBuilder",this.promise=null}asStream(){return new Un(this.downloadFn,this.shouldThrowOnError)}then(r,e){return this.getPromise().then(r,e)}catch(r){return this.getPromise().catch(r)}finally(r){return this.getPromise().finally(r)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var r=this;try{return{data:await(await r.downloadFn()).blob(),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(C(e))return{data:null,error:e};throw e}}};const Dn={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},zt={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Bn=class{constructor(r,e={},t,s){this.shouldThrowOnError=!1,this.url=r,this.headers=e,this.bucketId=t,this.fetch=bt(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(r,e,t,s){var n=this;try{let i;const a=j(j({},zt),s);let l=j(j({},n.headers),r==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&t instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",n.encodeMetadata(c)),i.append("",t)):typeof FormData<"u"&&t instanceof FormData?(i=t,i.has("cacheControl")||i.append("cacheControl",a.cacheControl),c&&!i.has("metadata")&&i.append("metadata",n.encodeMetadata(c))):(i=t,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,c&&(l["x-metadata"]=n.toBase64(n.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!a.duplex&&(a.duplex="half")),s?.headers&&(l=j(j({},l),s.headers));const u=n._removeEmptyFolders(e),d=n._getFinalPath(u),h=await(r=="PUT"?dt:F)(n.fetch,`${n.url}/object/${d}`,i,j({headers:l},a?.duplex?{duplex:a.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(C(i))return{data:null,error:i};throw i}}async upload(r,e,t){return this.uploadOrUpdate("POST",r,e,t)}async uploadToSignedUrl(r,e,t,s){var n=this;const i=n._removeEmptyFolders(r),a=n._getFinalPath(i),l=new URL(n.url+`/object/upload/sign/${a}`);l.searchParams.set("token",e);try{let c;const u=j({upsert:zt.upsert},s),d=j(j({},n.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&t instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",t)):typeof FormData<"u"&&t instanceof FormData?(c=t,c.append("cacheControl",u.cacheControl)):(c=t,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:i,fullPath:(await dt(n.fetch,l.toString(),c,{headers:d})).Key},error:null}}catch(c){if(n.shouldThrowOnError)throw c;if(C(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(r,e){var t=this;try{let s=t._getFinalPath(r);const n=j({},t.headers);e?.upsert&&(n["x-upsert"]="true");const i=await F(t.fetch,`${t.url}/object/upload/sign/${s}`,{},{headers:n}),a=new URL(t.url+i.url),l=a.searchParams.get("token");if(!l)throw new Ve("No token returned by API");return{data:{signedUrl:a.toString(),path:r,token:l},error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(C(s))return{data:null,error:s};throw s}}async update(r,e,t){return this.uploadOrUpdate("PUT",r,e,t)}async move(r,e,t){var s=this;try{return{data:await F(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:r,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(C(n))return{data:null,error:n};throw n}}async copy(r,e,t){var s=this;try{return{data:{path:(await F(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:r,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:s.headers})).Key},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(C(n))return{data:null,error:n};throw n}}async createSignedUrl(r,e,t){var s=this;try{let n=s._getFinalPath(r),i=await F(s.fetch,`${s.url}/object/sign/${n}`,j({expiresIn:e},t?.transform?{transform:t.transform}:{}),{headers:s.headers});const a=t?.download?`&download=${t.download===!0?"":t.download}`:"";return i={signedUrl:encodeURI(`${s.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(C(n))return{data:null,error:n};throw n}}async createSignedUrls(r,e,t){var s=this;try{const n=await F(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:r},{headers:s.headers}),i=t?.download?`&download=${t.download===!0?"":t.download}`:"";return{data:n.map(a=>j(j({},a),{},{signedUrl:a.signedURL?encodeURI(`${s.url}${a.signedURL}${i}`):null})),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(C(n))return{data:null,error:n};throw n}}download(r,e){const t=typeof e?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(e?.transform||{}),n=s?`?${s}`:"",i=this._getFinalPath(r),a=()=>je(this.fetch,`${this.url}/${t}/${i}${n}`,{headers:this.headers,noResolveJson:!0});return new Ln(a,this.shouldThrowOnError)}async info(r){var e=this;const t=e._getFinalPath(r);try{return{data:ut(await je(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(C(s))return{data:null,error:s};throw s}}async exists(r){var e=this;const t=e._getFinalPath(r);try{return await $n(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(C(s)&&s instanceof ct){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}}getPublicUrl(r,e){const t=this._getFinalPath(r),s=[],n=e?.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&s.push(n);const i=typeof e?.transform<"u"?"render/image":"object",a=this.transformOptsToQueryString(e?.transform||{});a!==""&&s.push(a);let l=s.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${t}${l}`)}}}async remove(r){var e=this;try{return{data:await vt(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:r},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(C(t))return{data:null,error:t};throw t}}async list(r,e,t){var s=this;try{const n=j(j(j({},Dn),e),{},{prefix:r||""});return{data:await F(s.fetch,`${s.url}/object/list/${s.bucketId}`,n,{headers:s.headers},t),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(C(n))return{data:null,error:n};throw n}}async listV2(r,e){var t=this;try{const s=j({},r);return{data:await F(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,s,{headers:t.headers},e),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(C(s))return{data:null,error:s};throw s}}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const e=[];return r.width&&e.push(`width=${r.width}`),r.height&&e.push(`height=${r.height}`),r.resize&&e.push(`resize=${r.resize}`),r.format&&e.push(`format=${r.format}`),r.quality&&e.push(`quality=${r.quality}`),e.join("&")}};const _r="2.90.1",xr={"X-Client-Info":`storage-js/${_r}`};var Mn=class{constructor(r,e={},t,s){this.shouldThrowOnError=!1;const n=new URL(r);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=j(j({},xr),e),this.fetch=bt(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(r){var e=this;try{const t=e.listBucketOptionsToQueryString(r);return{data:await je(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(C(t))return{data:null,error:t};throw t}}async getBucket(r){var e=this;try{return{data:await je(e.fetch,`${e.url}/bucket/${r}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(C(t))return{data:null,error:t};throw t}}async createBucket(r,e={public:!1}){var t=this;try{return{data:await F(t.fetch,`${t.url}/bucket`,{id:r,name:r,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(C(s))return{data:null,error:s};throw s}}async updateBucket(r,e){var t=this;try{return{data:await dt(t.fetch,`${t.url}/bucket/${r}`,{id:r,name:r,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(C(s))return{data:null,error:s};throw s}}async emptyBucket(r){var e=this;try{return{data:await F(e.fetch,`${e.url}/bucket/${r}/empty`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(C(t))return{data:null,error:t};throw t}}async deleteBucket(r){var e=this;try{return{data:await vt(e.fetch,`${e.url}/bucket/${r}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(C(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(r){const e={};return r&&("limit"in r&&(e.limit=String(r.limit)),"offset"in r&&(e.offset=String(r.offset)),r.search&&(e.search=r.search),r.sortColumn&&(e.sortColumn=r.sortColumn),r.sortOrder&&(e.sortOrder=r.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},qn=class{constructor(r,e={},t){this.shouldThrowOnError=!1,this.url=r.replace(/\/$/,""),this.headers=j(j({},xr),e),this.fetch=bt(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(r){var e=this;try{return{data:await F(e.fetch,`${e.url}/bucket`,{name:r},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(C(t))return{data:null,error:t};throw t}}async listBuckets(r){var e=this;try{const t=new URLSearchParams;r?.limit!==void 0&&t.set("limit",r.limit.toString()),r?.offset!==void 0&&t.set("offset",r.offset.toString()),r?.sortColumn&&t.set("sortColumn",r.sortColumn),r?.sortOrder&&t.set("sortOrder",r.sortOrder),r?.search&&t.set("search",r.search);const s=t.toString(),n=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await je(e.fetch,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(C(t))return{data:null,error:t};throw t}}async deleteBucket(r){var e=this;try{return{data:await vt(e.fetch,`${e.url}/bucket/${r}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(C(t))return{data:null,error:t};throw t}}from(r){var e=this;if(!On(r))throw new Ve("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new jn({baseUrl:this.url,catalogName:r,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(t,{get(n,i){const a=n[i];return typeof a!="function"?a:async(...l)=>{try{return{data:await a.apply(n,l),error:null}}catch(c){if(s)throw c;return{data:null,error:c}}}}})}};const _t={"X-Client-Info":`storage-js/${_r}`,"Content-Type":"application/json"};var kr=class extends Error{constructor(r){super(r),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function B(r){return typeof r=="object"&&r!==null&&"__isStorageVectorsError"in r}var Xe=class extends kr{constructor(r,e,t){super(r),this.name="StorageVectorsApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Fn=class extends kr{constructor(r,e){super(r),this.name="StorageVectorsUnknownError",this.originalError=e}};const xt=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),zn=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},Vt=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Vn=async(r,e,t)=>{if(r&&typeof r=="object"&&"status"in r&&"ok"in r&&typeof r.status=="number"&&!t?.noResolveJson){const s=r.status||500,n=r;if(typeof n.json=="function")n.json().then(i=>{const a=i?.statusCode||i?.code||s+"";e(new Xe(Vt(i),s,a))}).catch(()=>{const i=s+"";e(new Xe(n.statusText||`HTTP ${s} error`,s,i))});else{const i=s+"";e(new Xe(n.statusText||`HTTP ${s} error`,s,i))}}else e(new Fn(Vt(r),r))},Wn=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return s?(zn(s)?(n.headers=j({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(s)):n.body=s,j(j({},n),t)):n};async function Kn(r,e,t,s,n,i){return new Promise((a,l)=>{r(t,Wn(e,s,n,i)).then(c=>{if(!c.ok)throw c;if(s?.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>a(c)).catch(c=>Vn(c,l,s))})}async function M(r,e,t,s,n){return Kn(r,"POST",e,s,n,t)}var Hn=class{constructor(r,e={},t){this.shouldThrowOnError=!1,this.url=r.replace(/\/$/,""),this.headers=j(j({},_t),e),this.fetch=xt(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(r){var e=this;try{return{data:await M(e.fetch,`${e.url}/CreateIndex`,r,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(B(t))return{data:null,error:t};throw t}}async getIndex(r,e){var t=this;try{return{data:await M(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:r,indexName:e},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(B(s))return{data:null,error:s};throw s}}async listIndexes(r){var e=this;try{return{data:await M(e.fetch,`${e.url}/ListIndexes`,r,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(B(t))return{data:null,error:t};throw t}}async deleteIndex(r,e){var t=this;try{return{data:await M(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:r,indexName:e},{headers:t.headers})||{},error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(B(s))return{data:null,error:s};throw s}}},Gn=class{constructor(r,e={},t){this.shouldThrowOnError=!1,this.url=r.replace(/\/$/,""),this.headers=j(j({},_t),e),this.fetch=xt(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(r){var e=this;try{if(r.vectors.length<1||r.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await M(e.fetch,`${e.url}/PutVectors`,r,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(B(t))return{data:null,error:t};throw t}}async getVectors(r){var e=this;try{return{data:await M(e.fetch,`${e.url}/GetVectors`,r,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(B(t))return{data:null,error:t};throw t}}async listVectors(r){var e=this;try{if(r.segmentCount!==void 0){if(r.segmentCount<1||r.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(r.segmentIndex!==void 0&&(r.segmentIndex<0||r.segmentIndex>=r.segmentCount))throw new Error(`segmentIndex must be between 0 and ${r.segmentCount-1}`)}return{data:await M(e.fetch,`${e.url}/ListVectors`,r,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(B(t))return{data:null,error:t};throw t}}async queryVectors(r){var e=this;try{return{data:await M(e.fetch,`${e.url}/QueryVectors`,r,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(B(t))return{data:null,error:t};throw t}}async deleteVectors(r){var e=this;try{if(r.keys.length<1||r.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await M(e.fetch,`${e.url}/DeleteVectors`,r,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(B(t))return{data:null,error:t};throw t}}},Jn=class{constructor(r,e={},t){this.shouldThrowOnError=!1,this.url=r.replace(/\/$/,""),this.headers=j(j({},_t),e),this.fetch=xt(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(r){var e=this;try{return{data:await M(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:r},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(B(t))return{data:null,error:t};throw t}}async getBucket(r){var e=this;try{return{data:await M(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:r},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(B(t))return{data:null,error:t};throw t}}async listBuckets(r={}){var e=this;try{return{data:await M(e.fetch,`${e.url}/ListVectorBuckets`,r,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(B(t))return{data:null,error:t};throw t}}async deleteBucket(r){var e=this;try{return{data:await M(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:r},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(B(t))return{data:null,error:t};throw t}}},Yn=class extends Jn{constructor(r,e={}){super(r,e.headers||{},e.fetch)}from(r){return new Xn(this.url,this.headers,r,this.fetch)}async createBucket(r){var e=()=>super.createBucket,t=this;return e().call(t,r)}async getBucket(r){var e=()=>super.getBucket,t=this;return e().call(t,r)}async listBuckets(r={}){var e=()=>super.listBuckets,t=this;return e().call(t,r)}async deleteBucket(r){var e=()=>super.deleteBucket,t=this;return e().call(t,r)}},Xn=class extends Hn{constructor(r,e,t,s){super(r,e,s),this.vectorBucketName=t}async createIndex(r){var e=()=>super.createIndex,t=this;return e().call(t,j(j({},r),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(r={}){var e=()=>super.listIndexes,t=this;return e().call(t,j(j({},r),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(r){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,r)}async deleteIndex(r){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,r)}index(r){return new Qn(this.url,this.headers,this.vectorBucketName,r,this.fetch)}},Qn=class extends Gn{constructor(r,e,t,s,n){super(r,e,n),this.vectorBucketName=t,this.indexName=s}async putVectors(r){var e=()=>super.putVectors,t=this;return e().call(t,j(j({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(r){var e=()=>super.getVectors,t=this;return e().call(t,j(j({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(r={}){var e=()=>super.listVectors,t=this;return e().call(t,j(j({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(r){var e=()=>super.queryVectors,t=this;return e().call(t,j(j({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(r){var e=()=>super.deleteVectors,t=this;return e().call(t,j(j({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},Zn=class extends Mn{constructor(r,e={},t,s){super(r,e,t,s)}from(r){return new Bn(this.url,this.headers,r,this.fetch)}get vectors(){return new Yn(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new qn(this.url+"/iceberg",this.headers,this.fetch)}};const Sr="2.90.1",fe=30*1e3,ht=3,Qe=ht*fe,ei="http://localhost:9999",ti="supabase.auth.token",ri={"X-Client-Info":`gotrue-js/${Sr}`},ft="X-Supabase-Api-Version",jr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},si=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ni=600*1e3;class Ee extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function k(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class ii extends Ee{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function ai(r){return k(r)&&r.name==="AuthApiError"}class re extends Ee{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class G extends Ee{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class D extends G{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function oi(r){return k(r)&&r.name==="AuthSessionMissingError"}class ae extends G{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Pe extends G{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class $e extends G{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function li(r){return k(r)&&r.name==="AuthImplicitGrantRedirectError"}class Wt extends G{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ci extends G{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class gt extends G{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ze(r){return k(r)&&r.name==="AuthRetryableFetchError"}class Kt extends G{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class pt extends G{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ht=` 	
\r=`.split(""),ui=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Ht.length;e+=1)r[Ht[e].charCodeAt(0)]=-2;for(let e=0;e<Be.length;e+=1)r[Be[e].charCodeAt(0)]=e;return r})();function Gt(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Be[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Be[s]),e.queuedBits-=6}}function Er(r,e,t){const s=ui[r];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Jt(r){const e=[],t=a=>{e.push(String.fromCodePoint(a))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=a=>{fi(a,s,t)};for(let a=0;a<r.length;a+=1)Er(r.charCodeAt(a),n,i);return e.join("")}function di(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function hi(r,e){for(let t=0;t<r.length;t+=1){let s=r.charCodeAt(t);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(r.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}di(s,e)}}function fi(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let s=1;s<6;s+=1)if((r>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function we(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<r.length;n+=1)Er(r.charCodeAt(n),t,s);return new Uint8Array(e)}function gi(r){const e=[];return hi(r,t=>e.push(t)),new Uint8Array(e)}function se(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};return r.forEach(n=>Gt(n,t,s)),Gt(null,t,s),e.join("")}function pi(r){return Math.round(Date.now()/1e3)+r}function mi(){return Symbol("auth-callback")}const L=()=>typeof window<"u"&&typeof document<"u",Q={tested:!1,writable:!1},Tr=()=>{if(!L())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Q.tested)return Q.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Q.tested=!0,Q.writable=!0}catch{Q.tested=!0,Q.writable=!1}return Q.writable};function yi(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const Ar=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),wi=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",ge=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Z=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},U=async(r,e)=>{await r.removeItem(e)};class We{constructor(){this.promise=new We.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}We.promiseConstructor=Promise;function et(r){const e=r.split(".");if(e.length!==3)throw new pt("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!si.test(e[s]))throw new pt("JWT not in base64url format");return{header:JSON.parse(Jt(e[0])),payload:JSON.parse(Jt(e[1])),signature:we(e[2]),raw:{header:e[0],payload:e[1]}}}async function bi(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function vi(r,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await r(i);if(!e(i,null,a)){s(a);return}}catch(a){if(!e(i,a)){n(a);return}}})()})}function _i(r){return("0"+r.toString(16)).substr(-2)}function xi(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let i=0;i<56;i++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,_i).join("")}async function ki(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function Si(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await ki(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function oe(r,e,t=!1){const s=xi();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await ge(r,`${e}-code-verifier`,n);const i=await Si(s);return[i,s===i?"plain":"s256"]}const ji=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ei(r){const e=r.headers.get(ft);if(!e||!e.match(ji))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Ti(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function Ai(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Oi=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function le(r){if(!Oi.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function tt(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ri(r,e){return new Proxy(r,{get:(t,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,s,n)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,s,n)}})}function Yt(r){return JSON.parse(JSON.stringify(r))}const ee=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Ci=[502,503,504];async function Xt(r){var e;if(!wi(r))throw new gt(ee(r),0);if(Ci.includes(r.status))throw new gt(ee(r),r.status);let t;try{t=await r.json()}catch(i){throw new re(ee(i),i)}let s;const n=Ei(r);if(n&&n.getTime()>=jr["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new Kt(ee(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new D}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Kt(ee(t),r.status,t.weak_password.reasons);throw new ii(ee(t),r.status||500,s)}const Ni=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function S(r,e,t,s){var n;const i=Object.assign({},s?.headers);i[ft]||(i[ft]=jr["2024-01-01"].name),s?.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const a=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(a.redirect_to=s.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await Ii(r,e,t+l,{headers:i,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(c):{data:Object.assign({},c),error:null}}async function Ii(r,e,t,s,n,i){const a=Ni(e,s,n,i);let l;try{l=await r(t,Object.assign({},a))}catch(c){throw console.error(c),new gt(ee(c),0)}if(l.ok||await Xt(l),s?.noResolveJson)return l;try{return await l.json()}catch(c){await Xt(c)}}function q(r){var e;let t=null;Ui(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=pi(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function Qt(r){const e=q(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function X(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function Pi(r){return{data:r,error:null}}function $i(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:i}=r,a=ze(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:i},c=Object.assign({},a);return{data:{properties:l,user:c},error:null}}function Zt(r){return r}function Ui(r){return r.access_token&&r.refresh_token&&r.expires_in}const rt=["global","local","others"];class Li{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Ar(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=rt[0]){if(rt.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${rt.join(", ")}`);try{return await S(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(k(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await S(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:X})}catch(s){if(k(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=ze(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await S(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:$i,redirectTo:t?.redirectTo})}catch(t){if(k(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await S(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:X})}catch(t){if(k(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,i,a,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await S(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Zt});if(d.error)throw d.error;const h=await d.json(),g=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return f.length>0&&(f.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(p.split(";")[1].split("=")[1]);u[`${w}Page`]=m}),u.total=parseInt(g)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(k(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){le(e);try{return await S(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:X})}catch(t){if(k(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){le(e);try{return await S(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:X})}catch(s){if(k(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){le(e);try{return await S(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:X})}catch(s){if(k(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){le(e.userId);try{const{data:t,error:s}=await S(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(k(t))return{data:null,error:t};throw t}}async _deleteFactor(e){le(e.userId),le(e.id);try{return{data:await S(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(k(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,s,n,i,a,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await S(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Zt});if(d.error)throw d.error;const h=await d.json(),g=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return f.length>0&&(f.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(p.split(";")[1].split("=")[1]);u[`${w}Page`]=m}),u.total=parseInt(g)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(k(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await S(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(k(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await S(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(k(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await S(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(k(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await S(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(k(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await S(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(k(t))return{data:null,error:t};throw t}}}function er(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}const ce={debug:!!(globalThis&&Tr()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Or extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Di extends Or{}async function Bi(r,e,t){ce.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),ce.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){ce.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{ce.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw ce.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new Di(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(ce.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function Mi(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Rr(r){if(!/^0x[a-fA-F0-9]{40}$/.test(r))throw new Error(`@supabase/auth-js: Address "${r}" is invalid.`);return r.toLowerCase()}function qi(r){return parseInt(r,16)}function Fi(r){const e=new TextEncoder().encode(r);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function zi(r){var e;const{chainId:t,domain:s,expirationTime:n,issuedAt:i=new Date,nonce:a,notBefore:l,requestId:c,resources:u,scheme:d,uri:h,version:g}=r;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(g!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${g}`);if(!((e=r.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${r.statement}`)}const f=Rr(r.address),p=d?`${d}://${s}`:s,m=r.statement?`${r.statement}
`:"",w=`${p} wants you to sign in with your Ethereum account:
${f}

${m}`;let b=`URI: ${h}
Version: ${g}
Chain ID: ${t}${a?`
Nonce: ${a}`:""}
Issued At: ${i.toISOString()}`;if(n&&(b+=`
Expiration Time: ${n.toISOString()}`),l&&(b+=`
Not Before: ${l.toISOString()}`),c&&(b+=`
Request ID: ${c}`),u){let x=`
Resources:`;for(const y of u){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);x+=`
- ${y}`}b+=x}return`${w}
${b}`}class P extends Error{constructor({message:e,code:t,cause:s,name:n}){var i;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=n??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=t}}class Me extends P{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function Vi({error:r,options:e}){var t,s,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(e.signal instanceof AbortSignal)return new P({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else if(r.name==="ConstraintError"){if(((t=i.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new P({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:r});if(e.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new P({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:r});if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new P({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:r})}else{if(r.name==="InvalidStateError")return new P({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:r});if(r.name==="NotAllowedError")return new P({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new P({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:r}):new P({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:r});if(r.name==="SecurityError"){const a=window.location.hostname;if(Cr(a)){if(i.rp.id!==a)return new P({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new P({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new P({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:r})}else if(r.name==="UnknownError")return new P({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new P({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}function Wi({error:r,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(e.signal instanceof AbortSignal)return new P({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else{if(r.name==="NotAllowedError")return new P({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="SecurityError"){const s=window.location.hostname;if(Cr(s)){if(t.rpId!==s)return new P({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new P({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="UnknownError")return new P({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new P({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}class Ki{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Hi=new Ki;function Gi(r){if(!r)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(r);const{challenge:e,user:t,excludeCredentials:s}=r,n=ze(r,["challenge","user","excludeCredentials"]),i=we(e).buffer,a=Object.assign(Object.assign({},t),{id:we(t.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:i,user:a});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const u=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:we(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function Ji(r){if(!r)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(r);const{challenge:e,allowCredentials:t}=r,s=ze(r,["challenge","allowCredentials"]),n=we(e).buffer,i=Object.assign(Object.assign({},s),{challenge:n});if(t&&t.length>0){i.allowCredentials=new Array(t.length);for(let a=0;a<t.length;a++){const l=t[a];i.allowCredentials[a]=Object.assign(Object.assign({},l),{id:we(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function Yi(r){var e;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const t=r;return{id:r.id,rawId:r.id,response:{attestationObject:se(new Uint8Array(r.response.attestationObject)),clientDataJSON:se(new Uint8Array(r.response.clientDataJSON))},type:"public-key",clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Xi(r){var e;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const t=r,s=r.getClientExtensionResults(),n=r.response;return{id:r.id,rawId:r.id,response:{authenticatorData:se(new Uint8Array(n.authenticatorData)),clientDataJSON:se(new Uint8Array(n.clientDataJSON)),signature:se(new Uint8Array(n.signature)),userHandle:n.userHandle?se(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Cr(r){return r==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(r)}function tr(){var r,e;return!!(L()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((r=navigator?.credentials)===null||r===void 0?void 0:r.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Qi(r){try{const e=await navigator.credentials.create(r);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Me("Browser returned unexpected credential type",e)}:{data:null,error:new Me("Empty credential response",e)}}catch(e){return{data:null,error:Vi({error:e,options:r})}}}async function Zi(r){try{const e=await navigator.credentials.get(r);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Me("Browser returned unexpected credential type",e)}:{data:null,error:new Me("Empty credential response",e)}}catch(e){return{data:null,error:Wi({error:e,options:r})}}}const ea={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},ta={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function qe(...r){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),t=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of r)if(n)for(const i in n){const a=n[i];if(a!==void 0)if(Array.isArray(a))s[i]=a;else if(t(a))s[i]=a;else if(e(a)){const l=s[i];e(l)?s[i]=qe(l,a):s[i]=qe(a)}else s[i]=a}return s}function ra(r,e){return qe(ea,r,e||{})}function sa(r,e){return qe(ta,r,e||{})}class na{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:s,signal:n},i){try{const{data:a,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!a)return{data:null,error:l};const c=n??Hi.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:u}=a.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(a.webauthn.type){case"create":{const u=ra(a.webauthn.credential_options.publicKey,i?.create),{data:d,error:h}=await Qi({publicKey:u,signal:c});return d?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const u=sa(a.webauthn.credential_options.publicKey,i?.request),{data:d,error:h}=await Zi(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(a){return k(a)?{data:null,error:a}:{data:null,error:new re("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:t,webauthn:s}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!t)return{data:null,error:new Ee("rpId is required for WebAuthn authentication")};try{if(!tr())return{data:null,error:new re("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:s},signal:n},{request:i});if(!a)return{data:null,error:l};const{webauthn:c}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:c.type,rpId:t,rpOrigins:s,credential_response:c.credential_response}})}catch(a){return k(a)?{data:null,error:a}:{data:null,error:new re("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!t)return{data:null,error:new Ee("rpId is required for WebAuthn registration")};try{if(!tr())return{data:null,error:new re("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(g=>g.factor_type==="webauthn"&&g.friendly_name===e&&g.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d?.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:t,rpOrigins:s},signal:n},{create:i});return c?this._verify({factorId:a.id,challengeId:c.challengeId,webauthn:{rpId:t,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(a){return k(a)?{data:null,error:a}:{data:null,error:new re("Unexpected error in register",a)}}}}Mi();const ia={url:ei,storageKey:ti,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ri,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function rr(r,e,t){return await t()}const ue={};class Te{get jwks(){var e,t;return(t=(e=ue[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){ue[this.storageKey]=Object.assign(Object.assign({},ue[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=ue[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ue[this.storageKey]=Object.assign(Object.assign({},ue[this.storageKey]),{cachedAt:e})}constructor(e){var t,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},ia),e);if(this.storageKey=i.storageKey,this.instanceID=(t=Te.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,Te.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&L()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Li({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Ar(i.fetch),this.lock=i.lock||rr,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&L()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=Bi:this.lock=rr,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new na(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Tr()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=er(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=er(this.memoryStorage)),L()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Sr}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},s="none";if(L()&&(t=yi(window.location.href),this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce")),L()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),li(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:a,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return k(t)?this._returnResult({error:t}):this._returnResult({error:new re("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const i=await S(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:q}),{data:a,error:l}=i;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(k(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var t,s,n;try{let i;if("email"in e){const{email:d,password:h,options:g}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await oe(this.storage,this.storageKey)),i=await S(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g?.emailRedirectTo,body:{email:d,password:h,data:(t=g?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:g?.captchaToken},code_challenge:f,code_challenge_method:p},xform:q})}else if("phone"in e){const{phone:d,password:h,options:g}=e;i=await S(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=g?.data)!==null&&s!==void 0?s:{},channel:(n=g?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:q})}else throw new Pe("You must provide either an email or phone number and a password");const{data:a,error:l}=i;if(l||!a)return await U(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(await U(this.storage,`${this.storageKey}-code-verifier`),k(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:l}=e;t=await S(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Qt})}else if("phone"in e){const{phone:i,password:a,options:l}=e;t=await S(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Qt})}else throw new Pe("You must provide either an email or phone number and a password");const{data:s,error:n}=t;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const i=new ae;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(k(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,s,n,i,a,l,c,u,d,h,g;let f,p;if("message"in e)f=e.message,p=e.signature;else{const{chain:m,wallet:w,statement:b,options:x}=e;let y;if(L())if(typeof w=="object")y=w;else{const W=window;if("ethereum"in W&&typeof W.ethereum=="object"&&"request"in W.ethereum&&typeof W.ethereum.request=="function")y=W.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!x?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=w}const E=new URL((t=x?.url)!==null&&t!==void 0?t:window.location.href),R=await y.request({method:"eth_requestAccounts"}).then(W=>W).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!R||R.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const T=Rr(R[0]);let A=(s=x?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!A){const W=await y.request({method:"eth_chainId"});A=qi(W)}const J={domain:E.host,address:T,statement:b,uri:E.href,version:"1",chainId:A,nonce:(n=x?.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(a=(i=x?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(l=x?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=x?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=x?.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=x?.signInWithEthereum)===null||d===void 0?void 0:d.resources};f=zi(J),p=await y.request({method:"personal_sign",params:[Fi(f),T]})}try{const{data:m,error:w}=await S(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:p},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:q});if(w)throw w;if(!m||!m.session||!m.user){const b=new ae;return this._returnResult({data:{user:null,session:null},error:b})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:w})}catch(m){if(k(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(e){var t,s,n,i,a,l,c,u,d,h,g,f;let p,m;if("message"in e)p=e.message,m=e.signature;else{const{chain:w,wallet:b,statement:x,options:y}=e;let E;if(L())if(typeof b=="object")E=b;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))E=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!y?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=b}const R=new URL((t=y?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in E&&E.signIn){const T=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y?.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),x?{statement:x}:null));let A;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")A=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)A=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)p=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),m=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${R.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(n=(s=y?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=y?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((a=y?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((l=y?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((c=y?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((u=y?.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((h=(d=y?.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...y.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const T=await E.signMessage(new TextEncoder().encode(p),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=T}}try{const{data:w,error:b}=await S(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:se(m)},!((g=e.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:q});if(b)throw b;if(!w||!w.session||!w.user){const x=new ae;return this._returnResult({data:{user:null,session:null},error:x})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:b})}catch(w){if(k(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async _exchangeCodeForSession(e){const t=await Z(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{if(!s&&this.flowType==="pkce")throw new ci;const{data:i,error:a}=await S(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:q});if(await U(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!i||!i.session||!i.user){const l=new ae;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:a})}catch(i){if(await U(this.storage,`${this.storageKey}-code-verifier`),k(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:i,nonce:a}=e,l=await S(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:q}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new ae;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(t){if(k(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,s,n,i,a;try{if("email"in e){const{email:l,options:c}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await oe(this.storage,this.storageKey));const{error:h}=await S(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c?.data)!==null&&t!==void 0?t:{},create_user:(s=c?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:d}=await S(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c?.data)!==null&&n!==void 0?n:{},create_user:(i=c?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(a=c?.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u?.message_id},error:d})}throw new Pe("You must provide either an email or phone number.")}catch(l){if(await U(this.storage,`${this.storageKey}-code-verifier`),k(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var t,s;try{let n,i;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:l}=await S(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:q});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,u=a.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(n){if(k(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var t,s,n,i,a;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await oe(this.storage,this.storageKey));const u=await S(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:Pi});return!((i=u.data)===null||i===void 0)&&i.url&&L()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(await U(this.storage,`${this.storageKey}-code-verifier`),k(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new D;const{error:n}=await S(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(k(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:a}=await S(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:a,error:l}=await S(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a?.message_id},error:l})}throw new Pe("You must provide either an email or phone number and a type")}catch(t){if(k(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Z(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Qe:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const a=await Z(this.userStorage,this.storageKey+"-user");a?.user?e.user=a.user:e.user=tt()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=Ri(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await S(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:X}):await this._useSession(async t=>{var s,n,i;const{data:a,error:l}=t;if(l)throw l;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new D}:await S(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:X})})}catch(t){if(k(t))return oi(t)&&(await this._removeSession(),await U(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new D;const a=n.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await oe(this.storage,this.storageKey));const{data:u,error:d}=await S(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:a.access_token,xform:X});if(d)throw d;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(s){if(await U(this.storage,`${this.storageKey}-code-verifier`),k(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new D;const t=Date.now()/1e3;let s=t,n=!0,i=null;const{payload:a}=et(e.access_token);if(a.exp&&(s=a.exp,n=s<=t),n){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(t){if(k(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:l}=t;if(l)throw l;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new D;const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(k(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!L())throw new $e("No browser detected.");if(e.error||e.error_description||e.error_code)throw new $e(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Wt("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new $e("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Wt("No code detected.");const{data:x,error:y}=await this._exchangeCodeForSession(e.code);if(y)throw y;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:l,expires_at:c,token_type:u}=e;if(!i||!l||!a||!u)throw new $e("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let g=d+h;c&&(g=parseInt(c));const f=g-d;f*1e3<=fe&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=g-h;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,g,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,g,d);const{data:m,error:w}=await this._getUser(i);if(w)throw w;const b={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:g,refresh_token:a,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:b,redirectType:e.type},error:null})}catch(s){if(k(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Z(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return this._returnResult({error:i});const a=(s=n.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:l}=await this.admin.signOut(a,e);if(l&&!(ai(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await U(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=mi(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:i},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await oe(this.storage,this.storageKey,!0));try{return await S(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(await U(this.storage,`${this.storageKey}-code-verifier`),k(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(k(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:s,error:n}=await this._useSession(async i=>{var a,l,c,u,d;const{data:h,error:g}=i;if(g)throw g;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await S(this.fetch,"GET",f,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return L()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:e.provider,url:s?.url},error:null})}catch(s){if(k(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var s;try{const{error:n,data:{session:i}}=t;if(n)throw n;const{options:a,provider:l,token:c,access_token:u,nonce:d}=e,h=await S(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:q}),{data:g,error:f}=h;return f?this._returnResult({data:{user:null,session:null},error:f}):!g||!g.session||!g.user?this._returnResult({data:{user:null,session:null},error:new ae}):(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("USER_UPDATED",g.session)),this._returnResult({data:g,error:f}))}catch(n){if(await U(this.storage,`${this.storageKey}-code-verifier`),k(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:i,error:a}=t;if(a)throw a;return await S(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(k(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await vi(async n=>(n>0&&await bi(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await S(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:q})),(n,i)=>{const a=200*Math.pow(2,n);return i&&Ze(i)&&Date.now()+a-s<fe})}catch(s){if(this._debug(t,"error",s),k(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),L()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await Z(this.storage,this.storageKey);if(n&&this.userStorage){let a=await Z(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:n.user},await ge(this.userStorage,this.storageKey+"-user",a)),n.user=(e=a?.user)!==null&&e!==void 0?e:tt()}else if(n&&!n.user&&!n.user){const a=await Z(this.storage,this.storageKey+"-user");a&&a?.user?(n.user=a.user,await U(this.storage,this.storageKey+"-user"),await ge(this.storage,this.storageKey,n)):n.user=tt()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Qe;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${Qe}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),Ze(a)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(n.access_token);!l&&a?.user?(n.user=a.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(s,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new D;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new We;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new D;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(n,"error",i),k(i)){const a={data:null,error:i};return Ze(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){i.push(c)}});if(await Promise.all(a),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await U(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await ge(this.userStorage,this.storageKey+"-user",{user:t.user});const n=Object.assign({},t);delete n.user;const i=Yt(n);await ge(this.storage,this.storageKey,i)}else{const n=Yt(t);await ge(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await U(this.storage,this.storageKey),await U(this.storage,this.storageKey+"-code-verifier"),await U(this.storage,this.storageKey+"-user"),this.userStorage&&await U(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&L()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),fe);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/fe);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${fe}ms, refresh threshold is ${ht} ticks`),n<=ht&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Or)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!L()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,a]=await oe(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(l.toString())}if(s?.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;return i?this._returnResult({data:null,error:i}):await S(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(k(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:i,error:a}=t;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:u}=await S(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&c.type==="totp"&&(!((n=c?.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(t){if(k(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?Yi(e.webauthn.credential_response):Xi(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await S(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(t){if(k(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return this._returnResult({data:null,error:i});const a=await S(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});if(a.error)return a;const{data:l}=a;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Gi(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Ji(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(k(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=t?.factors)!==null&&e!==void 0?e:[])n.all.push(i),i.status==="verified"&&n[i.factor_type].push(i);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=et(s.access_token);let a=null;i.aal&&(a=i.aal);let l=a;((t=(e=s.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:s},error:n}=t;return n?this._returnResult({data:null,error:n}):s?await S(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new D})})}catch(t){if(k(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:n},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new D});const a=await S(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&L()&&!t?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(s){if(k(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:n},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new D});const a=await S(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&L()&&!t?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(s){if(k(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;return s?this._returnResult({data:null,error:s}):t?await S(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new D})})}catch(e){if(k(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:s},error:n}=t;return n?this._returnResult({data:null,error:n}):s?(await S(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new D})})}catch(t){if(k(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(l=>l.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+ni>n)return s;const{data:i,error:a}=await S(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:f,error:p}=await this.getSession();if(p||!f.session)return this._returnResult({data:null,error:p});s=f.session.access_token}const{header:n,payload:i,signature:a,raw:{header:l,payload:c}}=et(s);t?.allowExpired||Ti(i.exp);const u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!u){const{error:f}=await this.getUser(s);if(f)throw f;return{data:{claims:i,header:n,signature:a},error:null}}const d=Ai(n.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,a,gi(`${l}.${c}`)))throw new pt("Invalid JWT signature");return{data:{claims:i,header:n,signature:a},error:null}}catch(s){if(k(s))return this._returnResult({data:null,error:s});throw s}}}Te.nextInstanceID={};const aa=Te,oa="2.90.1";let be="";typeof Deno<"u"?be="deno":typeof document<"u"?be="web":typeof navigator<"u"&&navigator.product==="ReactNative"?be="react-native":be="node";const la={"X-Client-Info":`supabase-js-${be}/${oa}`},ca={headers:la},ua={schema:"public"},da={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ha={};function Ae(r){"@babel/helpers - typeof";return Ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(r)}function fa(r,e){if(Ae(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var s=t.call(r,e);if(Ae(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function ga(r){var e=fa(r,"string");return Ae(e)=="symbol"?e:e+""}function pa(r,e,t){return(e=ga(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function sr(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,s)}return t}function I(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?sr(Object(t),!0).forEach(function(s){pa(r,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):sr(Object(t)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(t,s))})}return r}const ma=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),ya=()=>Headers,wa=(r,e,t)=>{const s=ma(t),n=ya();return async(i,a)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:r;let u=new n(a?.headers);return u.has("apikey")||u.set("apikey",r),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),s(i,I(I({},a),{},{headers:u}))}};function ba(r){return r.endsWith("/")?r:r+"/"}function va(r,e){var t,s;const{db:n,auth:i,realtime:a,global:l}=r,{db:c,auth:u,realtime:d,global:h}=e,g={db:I(I({},c),n),auth:I(I({},u),i),realtime:I(I({},d),a),storage:{},global:I(I(I({},h),l),{},{headers:I(I({},(t=h?.headers)!==null&&t!==void 0?t:{}),(s=l?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return r.accessToken?g.accessToken=r.accessToken:delete g.accessToken,g}function _a(r){const e=r?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(ba(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var xa=class extends aa{constructor(r){super(r)}},ka=class{constructor(r,e,t){var s,n;this.supabaseUrl=r,this.supabaseKey=e;const i=_a(r);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const a=`sb-${i.hostname.split(".")[0]}-auth-token`,l={db:ua,realtime:ha,auth:I(I({},da),{},{storageKey:a}),global:ca},c=va(t??{},l);if(this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(n=c.global.headers)!==null&&n!==void 0?n:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=c.auth)!==null&&u!==void 0?u:{},this.headers,c.global.fetch)}this.fetch=wa(e,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(I({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new tn(new URL("rest/v1",i).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new Zn(this.storageUrl.href,this.headers,this.fetch,t?.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new Ys(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(r,e,t)}channel(r,e={config:{}}){return this.realtime.channel(r,e)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var r=this,e,t;if(r.accessToken)return await r.accessToken();const{data:s}=await r.auth.getSession();return(e=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:r.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:e,detectSessionInUrl:t,storage:s,userStorage:n,storageKey:i,flowType:a,lock:l,debug:c,throwOnError:u},d,h){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new xa({url:this.authUrl.href,headers:I(I({},g),d),storageKey:i,autoRefreshToken:r,persistSession:e,detectSessionInUrl:t,storage:s,userStorage:n,flowType:a,lock:l,debug:c,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(r){return new bn(this.realtimeUrl.href,I(I({},r),{},{params:I(I({},{apikey:this.supabaseKey}),r?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,e)=>{this._handleTokenChanged(r,"CLIENT",e?.access_token)})}_handleTokenChanged(r,e,t){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):r==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Sa=(r,e,t)=>new ka(r,e,t);function ja(){if(typeof window<"u")return!1;const r=globalThis.process;if(!r)return!1;const e=r.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}ja()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ea="https://hputeuurrlygeapzlydn.supabase.co",Ta="sb_publishable_KUT1-X_y8VKIoH6aVpq9fg_qsVBovi9";let mt=null;mt=Sa(Ea,Ta);const Aa=()=>{const[r,e]=_.useState({name:"",email:"",phone:"",subject:"",message:""}),[t,s]=_.useState("idle"),[n,i]=_.useState(!1),[a,l]=_.useState(!1),c=_.useRef();H.useEffect(()=>{const f=new IntersectionObserver(([m])=>{m.isIntersecting&&i(!0)},{threshold:.1}),p=document.getElementById("contact");return p&&f.observe(p),()=>f.disconnect()},[]);const u=f=>{const{name:p,value:m}=f.target;e(w=>({...w,[p]:m}))},d=async f=>{f.preventDefault(),s("sending");const p="service_yr5fl2q",m="template_a8h4rjw",w="iOjr3dwBPBnhBOiGn",b={name:r.name,email:r.email,phone:r.phone,subject:r.subject,message:r.message,source:"portfolio",status:"new",created_at:new Date().toISOString()};if(mt){const{error:y}=await mt.from("contact_messages").insert([b]);y?N("contact_form_supabase_error","Error",y.message||"Supabase insert failed"):N("contact_form_supabase_logged","Engagement","Contact form saved to Supabase")}const x={from_name:r.name,from_email:r.email,phone:r.phone,subject:r.subject,message:r.message,to_name:"Mahanadi"};try{const y=await ps.send(p,m,x,w);s("success"),ys({email:r.email,phone:r.phone,name:r.name,firstName:r.name.split(" ")[0],lastName:r.name.split(" ").slice(1).join(" ")}),setTimeout(()=>{s("idle"),e({name:"",email:"",phone:"",subject:"",message:""})},3e3)}catch(y){s("error"),N("contact_form_error","Error",`Contact form failed: ${y.text||y.message||"Unknown error"}`),setTimeout(()=>{s("idle")},3e3)}},h=[{icon:Le,label:"Email",value:"mahanadhip@gmail.com",href:"mailto:mahanadhip@gmail.com",color:"text-blue-600 dark:text-blue-400"},{icon:De,label:"LinkedIn",value:"/in/mahanadhi",href:"https://www.linkedin.com/in/mahanadhi/",color:"text-blue-700 dark:text-blue-300"},{icon:At,label:"Phone",value:"+91 6363149672",href:"tel:+916363149672",color:"text-green-600 dark:text-green-400"}],g=()=>{switch(t){case"sending":return o.jsxs(o.Fragment,{children:[o.jsx(v.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Sending..."]});case"success":return o.jsxs(o.Fragment,{children:[o.jsx(hs,{size:20}),"Message Sent!"]});case"error":return o.jsxs(o.Fragment,{children:[o.jsx(ds,{size:20}),"Failed. Try Again."]});default:return o.jsxs(o.Fragment,{children:[o.jsx(us,{size:20}),"Send Message"]})}};return o.jsx("section",{id:"contact",className:"pt-24 pb-20 lg:pt-32 lg:pb-24 px-8",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsxs(v.div,{initial:{opacity:0,y:20},animate:n?{opacity:1,y:0}:{},transition:{duration:.6},className:"text-center mb-16",children:[o.jsxs("h2",{className:"font-heading text-4xl lg:text-5xl mb-4",children:["Let's Build Something"," ",o.jsx("span",{className:"bg-gradient-to-r from-primary-light to-accent-green-light dark:from-primary-dark dark:to-accent-green-dark bg-clip-text text-transparent",children:"Amazing Together"})]}),o.jsx("p",{className:"text-xl text-text-light dark:text-text-dark max-w-2xl mx-auto",children:"I'm always open to discussing new products, ideas, or opportunities to create meaningful user experiences."})]}),o.jsx(v.div,{variants:gr,initial:"hidden",animate:n?"visible":"hidden",className:"max-w-6xl mx-auto",children:o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsxs(v.div,{variants:ve,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Get in Touch"}),o.jsx("p",{className:"text-text-light dark:text-text-dark mb-6",children:"Got a product idea that's keeping you up at night? A user problem that needs solving? Or just want to chat about the intersection of tech and common sense? Let's talk."})]}),o.jsxs("div",{className:"grid grid-cols-1 gap-4 relative",children:[h.map(f=>o.jsxs("a",{href:f.href,target:f.href.startsWith("http")?"_blank":void 0,rel:f.href.startsWith("http")?"noopener noreferrer":void 0,onClick:()=>N(`${f.label.toLowerCase()}_click`,"Contact",`${f.label} clicked`),className:"flex items-center justify-start px-6 py-4 w-full rounded-2xl gap-4 bg-white/28 dark:bg-black/24 backdrop-blur-3xl backdrop-saturate-150 text-text-light dark:text-text-dark hover:bg-white/40 dark:hover:bg-black/35 hover:shadow-md transition-all duration-300",children:[o.jsx("div",{className:`flex items-center justify-center w-12 h-12 ${f.color} bg-gray-100/80 dark:bg-gray-700/80 rounded-lg transition-colors flex-shrink-0`,children:o.jsx(f.icon,{size:20})}),o.jsxs("div",{className:"text-left",children:[o.jsx("p",{className:"font-medium text-text-light dark:text-text-dark truncate",children:f.label}),o.jsx("p",{className:"text-sm text-text-light dark:text-text-dark opacity-75 truncate",children:f.value})]})]},f.label)),o.jsxs("div",{className:"relative w-full",children:[o.jsxs("button",{type:"button",onClick:()=>{window.dispatchEvent(new CustomEvent("open-calendar-modal")),N("calendar_click","Contact","Schedule call button clicked")},onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),className:"flex items-center justify-start px-6 py-4 w-full rounded-2xl gap-4 bg-white/28 dark:bg-black/24 backdrop-blur-3xl backdrop-saturate-150 text-text-light dark:text-text-dark hover:bg-white/40 dark:hover:bg-black/35 hover:shadow-md transition-all duration-300",children:[o.jsx("div",{className:"flex items-center justify-center w-12 h-12 text-green-600 dark:text-green-400 bg-gray-100/80 dark:bg-gray-700/80 rounded-lg transition-colors flex-shrink-0",children:o.jsx(st,{size:20})}),o.jsxs("div",{className:"text-left",children:[o.jsx("p",{className:"font-medium text-text-light dark:text-text-dark truncate",children:"Schedule Call"}),o.jsx("p",{className:"text-sm text-text-light dark:text-text-dark opacity-75 truncate",children:"15-30 min chat"})]})]}),o.jsxs(v.div,{initial:{opacity:0,y:10,scale:.95},animate:a?{opacity:1,y:0,scale:1}:{opacity:0,y:10,scale:.95},transition:{duration:.2},className:"absolute top-full left-0 right-0 mt-2 p-3 bg-blue-50 dark:bg-blue-900 rounded-lg border border-blue-200 dark:border-blue-700 shadow-lg z-10",style:{pointerEvents:"none"},children:[o.jsx("div",{className:"absolute top-0 left-6 transform -translate-y-2 w-0 h-0 border-l-8 border-r-8 border-b-8 border-transparent border-b-blue-50 dark:border-b-blue-900/20"}),o.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[o.jsx("strong",{children:"Prefer a quick chat?"})," Schedule a 15-30 minute call to discuss your project ideas, timeline, and how we can collaborate effectively."]})]})]})]})]}),o.jsx(v.div,{variants:ve,children:o.jsxs("div",{className:"bg-white/60 dark:bg-black/40 backdrop-blur-lg rounded-3xl p-6 border border-white/40 dark:border-white/20 shadow-xl shadow-gray-200/20 dark:shadow-black/40",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx(lr,{size:24,className:"text-primary-light dark:text-primary-dark"}),o.jsx("h3",{className:"text-xl font-bold",children:"Send a Message"})]}),o.jsxs("form",{ref:c,onSubmit:d,className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-2 text-text-light dark:text-text-dark",children:"Your Name *"}),o.jsxs("div",{className:"relative",children:[o.jsx(cs,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),o.jsx("input",{type:"text",name:"name",id:"name",value:r.name,onChange:u,required:!0,className:"w-full pl-10 pr-3 py-3 rounded-lg bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark focus:border-transparent transition-all duration-300",placeholder:"John Doe"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium mb-2 text-text-light dark:text-text-dark",children:"Your Email *"}),o.jsxs("div",{className:"relative",children:[o.jsx(Le,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),o.jsx("input",{type:"email",name:"email",id:"email",value:r.email,onChange:u,required:!0,className:"w-full pl-10 pr-3 py-3 rounded-lg bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark focus:border-transparent transition-all duration-300",placeholder:"john@example.com"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium mb-2 text-text-light dark:text-text-dark",children:"Phone Number (Optional)"}),o.jsxs("div",{className:"relative",children:[o.jsx(At,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),o.jsx("input",{type:"tel",name:"phone",id:"phone",value:r.phone,onChange:u,className:"w-full pl-10 pr-3 py-3 rounded-lg bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark focus:border-transparent transition-all duration-300",placeholder:"+91 98765 43210"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"subject",className:"block text-sm font-medium mb-2 text-text-light dark:text-text-dark",children:"Subject *"}),o.jsx("input",{type:"text",name:"subject",id:"subject",value:r.subject,onChange:u,required:!0,className:"w-full p-3 rounded-lg bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark focus:border-transparent transition-all duration-300",placeholder:"Let's discuss a project..."})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"message",className:"block text-sm font-medium mb-2 text-text-light dark:text-text-dark",children:"Your Message *"}),o.jsx("textarea",{name:"message",id:"message",rows:"5",value:r.message,onChange:u,required:!0,className:"w-full p-3 rounded-lg bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark focus:border-transparent transition-all duration-300 resize-none",placeholder:"Tell me about your project, timeline, and how I can help..."})]}),o.jsx(me,{type:"submit",disabled:t==="sending",variant:"primary",size:"lg",className:`w-full flex items-center justify-center gap-2 ${t==="success"?"bg-green-500 text-white":t==="error"?"bg-red-500 text-white":""}`,"aria-describedby":"form-status",children:g()}),o.jsxs("div",{id:"form-status",role:"status","aria-live":"polite",className:"sr-only",children:[t==="sending"&&"Sending your message...",t==="success"&&"Message sent successfully!",t==="error"&&"Failed to send message. Please try again."]})]}),o.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"flex justify-center space-x-4",children:[o.jsx(me,{asLink:!0,href:"mailto:mahanadhip@gmail.com",onClick:()=>N("email_click","Contact","Email clicked"),variant:"secondary",size:"icon",className:"rounded-full",children:o.jsx(Le,{size:20})}),o.jsx(me,{asLink:!0,href:"https://www.linkedin.com/in/mahanadhi/",target:"_blank",rel:"noopener noreferrer",onClick:()=>N("linkedin_click","Contact","LinkedIn clicked"),variant:"secondary",size:"icon",className:"rounded-full",children:o.jsx(De,{size:20})}),o.jsx(me,{onClick:()=>{window.dispatchEvent(new CustomEvent("open-calendar-modal")),N("calendar_click","Contact","Schedule call button clicked")},variant:"secondary",size:"icon",className:"rounded-full",children:o.jsx(st,{size:20})})]})})]})})]})})]})})},Ue=()=>{const r=Fe(),[e,t]=_.useState("home");_.useEffect(()=>{const n=r.pathname;n==="/projects"?(t("projects"),document.title="Projects | Mahanadhi Parisara",pe("Projects Section","projects")):n==="/skills"?(t("skills"),document.title="Skills | Mahanadhi Parisara",pe("Skills Section","skills")):n==="/contact"?(t("contact"),document.title="Contact | Mahanadhi Parisara",pe("Contact Section","contact")):(t("home"),document.title="Mahanadhi Parisara | Product-Minded Dev",pe("Home Page","home"))},[r.pathname]);const s=()=>{switch(e){case"projects":return o.jsx(v.div,{variants:Re,initial:"initial",animate:"animate",exit:"exit",className:"min-h-screen pt-20",children:o.jsx(qs,{})},"projects");case"skills":return o.jsx(v.div,{variants:Re,initial:"initial",animate:"animate",exit:"exit",className:"min-h-screen pt-20",children:o.jsx(Ks,{})},"skills");case"contact":return o.jsx(v.div,{variants:Re,initial:"initial",animate:"animate",exit:"exit",className:"min-h-screen pt-20",children:o.jsx(Aa,{})},"contact");default:return o.jsxs(v.div,{variants:Re,initial:"initial",animate:"animate",exit:"exit",className:"min-h-screen",children:[o.jsx(v.div,{variants:Ct,children:o.jsx(Ds,{})}),o.jsx(v.div,{variants:Ct,children:o.jsx(Ms,{})})]},"home")}};return o.jsx(V,{mode:"wait",children:s()})},nr=()=>o.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 relative z-10",children:o.jsxs(v.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},className:"max-w-lg w-full text-center p-12 rounded-3xl bg-white/30 dark:bg-black/40 backdrop-blur-2xl border border-white/20 dark:border-white/10 shadow-2xl",children:[o.jsx("h1",{className:"font-heading text-8xl md:text-9xl font-bold text-transparent bg-clip-text bg-gradient-to-b from-gray-900 to-gray-500 dark:from-white dark:to-gray-600 mb-2",children:"404"}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Lost in Space?"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-8 leading-relaxed",children:"The page you're looking for seems to have drifted away into the void. Let's get you back to solid ground."}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[o.jsxs(yt,{to:"/",className:"inline-flex items-center justify-center gap-2 px-6 py-3 bg-primary-light dark:bg-primary-dark text-white rounded-xl font-medium shadow-lg hover:scale-105 transition-transform",children:[o.jsx(cr,{size:18}),"Mission Control"]}),o.jsxs("button",{onClick:()=>window.history.back(),className:"inline-flex items-center justify-center gap-2 px-6 py-3 bg-white/10 dark:bg-white/5 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-700 rounded-xl font-medium hover:bg-white/20 dark:hover:bg-white/10 transition-colors",children:[o.jsx(fs,{size:18}),"Go Back"]})]})]})}),Oa=H.lazy(()=>ir(()=>import("./Experience-4Wi9XU6W.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Ra=H.lazy(()=>ir(()=>import("./Pluto-GN0SAuKT.js"),__vite__mapDeps([7,4,2,1,8,3,5,6]))),Ca=qr([{path:"/",element:o.jsx($s,{}),errorElement:o.jsx(nr,{}),children:[{path:"/",element:o.jsx(Ue,{})},{path:"/projects",element:o.jsx(Ue,{})},{path:"/skills",element:o.jsx(Ue,{})},{path:"/contact",element:o.jsx(Ue,{})},{path:"/experience",element:o.jsx(_.Suspense,{fallback:o.jsx(Rt,{}),children:o.jsx(Oa,{})})},{path:"/pluto",element:o.jsx(_.Suspense,{fallback:o.jsx(Rt,{}),children:o.jsx(Ra,{})})},{path:"*",element:o.jsx(nr,{})}]}]);Ur.createRoot(document.getElementById("root")).render(o.jsx(H.StrictMode,{children:o.jsx(Us,{children:o.jsx(Fr,{router:Ca})})}));export{N as a,pe as t};
